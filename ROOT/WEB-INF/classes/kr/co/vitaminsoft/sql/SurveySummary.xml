<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SurveySummary">
	<sql id="summary_list_where">
		<if test="s_survey_nm != null and s_survey_nm != '' ">
			AND TT3.survey_nm LIKE CONCAT('%', #{s_survey_nm}, '%')
		</if>
		<if test="s_user_nm != null and s_user_nm != '' ">
			AND TT2.user_nm LIKE CONCAT('%', #{s_user_nm}, '%')
		</if>
		<if test="s_company_code != null and s_company_code != '' ">
			AND TT2.company_code = #{s_company_code}
		</if>
		<if test="s_recruit_survey_id != null and s_recruit_survey_id != '' ">
			AND TT1.recruit_survey_id = #{s_recruit_survey_id}
		</if>
		<if test="s_representative_yn != null and s_representative_yn != '' ">
			AND TT1.representative_yn = #{s_representative_yn}
		</if>
		<if test="s_similar_yn != null and s_similar_yn != '' ">
			AND TT1.similar_yn = #{s_similar_yn}
		</if>
	</sql>
	
	<!-- 전체설문조회 -->
	<select id="selectSurveySummaryList" parameterType="box" resultType="box">
		SELECT
		  TT1.recruit_survey_id
		  , TT1.responder_id
		  , TT1.summary_step
		  , DATE_FORMAT(TT1.complete_dt, '%Y-%m-%d') as complete_dt
		  , TT3.recruit_nm as recruit_survey_nm
		  , TT2.user_nm
		  , TT2.hp
		  , TT2.year_birth
		  , TT2.email
		  , TT4.code_nm as company_nm
		  , TT2.area
		  , TT5.code_nm as belong_nm
		  , TT6.code_nm as position_nm
		  , TT7.code_nm as job_nm
		  , TT8.code_nm as duty_nm
		  , TT9.code_nm as gender_nm
		  , TT10.code_nm as recruit_nm
		  , ROUND(TT1.va1,2) AS va1
          , ROUND(TT1.va2,2) AS va2
          , ROUND(TT1.va3,2) AS va3
          , ROUND(TT1.va4,2) AS va4
          , ROUND(TT1.pos,2) AS pos
          , ROUND(TT1.neg,2) AS neg
          , ROUND(TT1.iso,2) AS iso
          , ROUND(TT1.pas,2) AS pas
          , ROUND(TT1.rkt,2) AS rkt
          , ROUND(TT1.ect,2) AS ect
          , ROUND(TT1.nar,2) AS nar
          , ROUND(TT1.pow,2) AS pow
          , ROUND(TT1.sst,2) AS sst
          , ROUND(TT1.ats,2) AS ats
          , ROUND(TT1.rul,2) AS rul
          , ROUND(TT1.mor,2) AS mor
          , ROUND(TT1.dpr,2) AS dpr
          , ROUND(TT1.anx,2) AS anx
          , ROUND(TT1.ins,2) AS ins
          , ROUND(TT1.sten_va1,2) AS sten_va1
          , ROUND(TT1.sten_va2,2) AS sten_va2
          , ROUND(TT1.sten_va3,2) AS sten_va3
          , ROUND(TT1.sten_va4,2) AS sten_va4
          , ROUND(TT1.sten_pos,2) AS sten_pos
          , ROUND(TT1.sten_neg,2) AS sten_neg
          , ROUND(TT1.sten_iso,2) AS sten_iso
          , ROUND(TT1.sten_pas,2) AS sten_pas
          , ROUND(TT1.sten_rkt,2) AS sten_rkt
          , ROUND(TT1.sten_ect,2) AS sten_ect
          , ROUND(TT1.sten_nar,2) AS sten_nar
          , ROUND(TT1.sten_pow,2) AS sten_pow
          , ROUND(TT1.sten_sst,2) AS sten_sst
          , ROUND(TT1.sten_ats,2) AS sten_ats
          , ROUND(TT1.sten_rul,2) AS sten_rul
          , ROUND(TT1.sten_mor,2) AS sten_mor
          , ROUND(TT1.level_dpr,2) AS level_dpr
          , ROUND(TT1.level_anx,2) AS level_anx
          , ROUND(TT1.level_ins,2) AS level_ins
          , (CASE WHEN TT1.LEVEL_DPR = 1 THEN '양호'
				       WHEN TT1.LEVEL_DPR = 2 THEN '주의'
					   WHEN TT1.LEVEL_DPR = 3 THEN '심각'
					   ELSE '' END
			) AS dpr_txt <!-- 우울 -->
		  , (CASE WHEN TT1.LEVEL_ANX = 1 THEN '양호'
			       WHEN TT1.LEVEL_ANX = 2 THEN '주의'
				   WHEN TT1.LEVEL_ANX = 3 THEN '심각'
				   ELSE '' END
			) AS anx_txt <!-- 불안  -->
		  , (CASE WHEN TT1.LEVEL_INS = 1 THEN '양호'
			       WHEN TT1.LEVEL_INS = 2 THEN '주의'
				   WHEN TT1.LEVEL_INS = 3 THEN '심각'
				   ELSE '' END
			) AS ins_txt <!-- 불면 -->
          , TT1.char_unity AS char_unity
          , TT1.char_care AS char_care
          , TT1.char_truth AS char_truth
          , ROUND(TT1.core_ave,2) AS core_ave
          , ROUND(TT1.std_iso,2) AS std_iso
          , ROUND(TT1.std_pas,2) AS std_pas
          , ROUND(TT1.std_rkt,2) AS std_rkt
          , ROUND(TT1.std_ect,2) AS std_etc
          , ROUND(TT1.std_nar,2) AS std_nar
          , ROUND(TT1.std_pow,2) AS std_pow
          , ROUND(TT1.std_sst,2) AS std_sst
          , ROUND(TT1.std_ats,2) AS std_ats
          , ROUND(TT1.std_all,2) AS std_all
          , ROUND(TT1.sten_ans,2) AS sten_ans
          , ROUND(TT1.worth,2) AS worth
          , ROUND(TT1.personality,2) AS personality
          , ROUND(TT1.worth_similar,2) AS worth_similar
          , ROUND(TT1.personality_similar,2) AS personality_similar
          , ROUND(TT1.total_similar,2) AS total_similar
		  , TT1.similar_rank
		  , TT1.reg_id
		  , DATE_FORMAT(TT1.reg_dt, '%Y-%m-%d') as reg_dt
		  , TT1.edit_id
		  , DATE_FORMAT(TT1.edit_dt, '%Y-%m-%d') as edit_dt
		FROM
			TB_SURVEY_SUMMARY TT1 INNER JOIN SV_USER TT2 ON TT1.RESPONDER_ID = TT2.ID
			INNER JOIN SV_RECRUIT_SURVEY TT3 ON TT1.RECRUIT_SURVEY_ID = TT3.ID
			LEFT OUTER JOIN SV_CODE TT4 ON TT4.UP_CODE = 'COMPANY' AND TT4.CODE = TT2.COMPANY_CODE
			LEFT OUTER JOIN SV_CODE TT5 ON TT5.UP_CODE = 'BELONG' AND TT5.CODE = TT2.BELONG_CODE
			LEFT OUTER JOIN SV_CODE TT6 ON TT6.UP_CODE = 'POSITION_TYPE' AND TT6.CODE = TT2.POSITION_CODE
			LEFT OUTER JOIN SV_CODE TT7 ON TT7.UP_CODE = 'JOB_TYPE' AND TT7.CODE = TT2.JOB_CODE
			LEFT OUTER JOIN SV_CODE TT8 ON TT8.UP_CODE = 'DUTY_TYPE' AND TT8.CODE = TT2.DUTY_CODE
			LEFT OUTER JOIN SV_CODE TT9 ON TT9.UP_CODE = 'GENDER_TYPE' AND TT9.CODE = TT2.GENDER_CODE
			LEFT OUTER JOIN SV_CODE TT10 ON TT10.UP_CODE = 'RECRUIT_TYPE' AND TT10.CODE = TT2.RECRUIT_CODE
			WHERE 1=1
		<include refid="summary_list_where"/>
		ORDER BY TT1.RECRUIT_SURVEY_ID DESC,TT1.REG_DT DESC
		LIMIT ${numPerPage} OFFSET ${startRow}
	</select>

	<select id="selectSurveySummaryListCount" parameterType="box" resultType="Integer">
		SELECT
			 COUNT(*) AS TOTAL_CNT
		FROM
			TB_SURVEY_SUMMARY TT1 INNER JOIN SV_USER TT2 ON TT1.RESPONDER_ID = TT2.ID
			INNER JOIN SV_RECRUIT_SURVEY TT3 ON TT1.RECRUIT_SURVEY_ID = TT3.ID
		WHERE 1=1
		<include refid="summary_list_where"/>
	</select>
	
	<!-- 설문상세뷰 -->
	<select id="getSurveySummaryView" parameterType="box" resultType="box">
		SELECT 
			recruit_survey_id
			, recruit_survey_id AS survey_id
		    , responder_id
		    , va1
		    , va2
		    , va3
		    , va4
		    , pos
		    , neg
		    , iso 
		    , pas
		    , rkt
		    , ect
		    , nar
		    , pow
		    , sst
		    , ats
		    , rul
		    , mor
		    , dpr
		    , anx
		    , ins
		    , sten_va1
		    , sten_va2
		    , sten_va3
		    , sten_va4
		    , sten_pos
		    , sten_neg
		    , sten_iso
		    , sten_pas
		    , sten_rkt
		    , sten_ect
		    , sten_nar
		    , sten_pow
		    , sten_sst
		    , sten_ats
		    , sten_rul
		    , sten_mor
		    , level_dpr
		    , level_anx
		    , level_ins
		    , char_unity
		    , char_care
		    , char_truth
		    , core_ave
		    , std_iso
		    , std_pas
		    , std_rkt
		    , std_ect
		    , std_nar
		    , std_pow
		    , std_sst
		    , std_ats
		    , std_all
		    , sten_ans
			, reg_id
			, DATE_FORMAT(reg_dt, '%Y-%m-%d') as reg_dt
			, edit_id
			, DATE_FORMAT(edit_dt, '%Y-%m-%d') as edit_dt
		FROM TB_SURVEY_SUMMARY
		WHERE RECRUIT_SURVEY_ID = #{recruit_survey_id}
		AND RESPONDER_ID = #{responder_id}
	</select>
	
	<!-- 유사구성원에서 종합등급 추출 -->
	<select id="getSurveySummaryTotalLevel" parameterType="box" resultType="box">
		SELECT TTT1.rank_rate, TTT1.rank
		,(
		CASE WHEN TTT1.CHAR_UNITY = 'F' OR TTT1.CHAR_CARE = 'F' THEN 'F' 
		     WHEN (IFNULL(TTT1.STD_ALL_VALUE,0) + IFNULL(TTT1.CORE_AVE_VALUE,0)) &gt;= 7 THEN 'A'
		     WHEN (IFNULL(TTT1.STD_ALL_VALUE,0) + IFNULL(TTT1.CORE_AVE_VALUE,0)) &gt;= 6 THEN 'B'
		     WHEN (IFNULL(TTT1.STD_ALL_VALUE,0) + IFNULL(TTT1.CORE_AVE_VALUE,0)) &gt;= 4 THEN 'C'
		     ELSE 'D' END) AS total_value <!-- 전체 -->
		,(
		CASE WHEN TTT1.CHAR_UNITY = 'F' OR TTT1.CHAR_CARE = 'F' THEN '부적격' 
		     WHEN (IFNULL(TTT1.STD_ALL_VALUE,0) + IFNULL(TTT1.CORE_AVE_VALUE,0)) &gt;= 7 THEN '우수'
		     WHEN (IFNULL(TTT1.STD_ALL_VALUE,0) + IFNULL(TTT1.CORE_AVE_VALUE,0)) &gt;= 6 THEN '보통'
		     WHEN (IFNULL(TTT1.STD_ALL_VALUE,0) + IFNULL(TTT1.CORE_AVE_VALUE,0)) &gt;= 4 THEN '미흡'
		     ELSE '매우미흡' END) AS total_text_value
		,(
		CASE WHEN TTT1.CHAR_UNITY = 'F' OR TTT1.CHAR_CARE = 'F' THEN 'F' 
		     WHEN IFNULL(TTT1.STD_ALL_VALUE111,0) &gt;= 11 THEN 'A'
		     WHEN IFNULL(TTT1.STD_ALL_VALUE111,0) &gt;= 9 THEN 'B'
		     ELSE 'C' END) AS std_all_value111 <!-- 인성 -->
		,(
		CASE WHEN TTT1.CHAR_UNITY = 'F' OR TTT1.CHAR_CARE = 'F' THEN '부적격' 
		     WHEN IFNULL(TTT1.STD_ALL_VALUE111,0) &gt;= 11 THEN '우수'
		     WHEN IFNULL(TTT1.STD_ALL_VALUE111,0) &gt;= 9 THEN '보통'
		     ELSE '미흡' END) AS std_all_text_value111
		,(
		CASE WHEN IFNULL(TTT1.CORE_AVE_VALUE,0) = 4 THEN 'A'
		     WHEN IFNULL(TTT1.CORE_AVE_VALUE,0) = 3 THEN 'B'
		     WHEN IFNULL(TTT1.CORE_AVE_VALUE,0) = 2 THEN 'C'
		     ELSE 'D' END) AS core_ave_value <!-- 핵심가치 -->
		,(
		CASE WHEN IFNULL(TTT1.CORE_AVE_VALUE,0) &gt;= 4 THEN '우수'
		     WHEN IFNULL(TTT1.CORE_AVE_VALUE,0) &gt;= 3 THEN '보통'
		     WHEN IFNULL(TTT1.CORE_AVE_VALUE,0) &gt;= 2 THEN '미흡'
		     ELSE '매우미흡' END) AS core_ave_text_value
		,total_similar
		,personality_similar
		,worth_similar
		,sten_ans
		FROM 
		(
		SELECT TT1.CHAR_UNITY
		,TT1.CHAR_CARE
		,TT1.CHAR_TRUTH
		,ROUND(TT1.TOTAL_SIMILAR) AS TOTAL_SIMILAR
		,ROUND(TT1.PERSONALITY_SIMILAR) AS PERSONALITY_SIMILAR
		,ROUND(TT1.WORTH_SIMILAR) AS WORTH_SIMILAR
		,TT1.STEN_ANS
		,TT2.rank
		,ROUND(TT2.rank/(SELECT COUNT(*) FROM TB_HOLDER_SUMMARY T1 INNER JOIN SV_SIMILAR_USER T2 ON T1.RESPONDER_ID = T2.USER_ID WHERE T2.RECRUIT_SURVEY_ID = #{recruit_survey_id})*100,1) AS rank_rate
		,(
		CASE WHEN IFNULL(ROUND(TT2.rank/(SELECT COUNT(*) FROM TB_HOLDER_SUMMARY)*100,1),0) &gt;= 85 THEN 4
		     WHEN IFNULL(ROUND(TT2.rank/(SELECT COUNT(*) FROM TB_HOLDER_SUMMARY)*100,1),0) &gt;= 40 THEN 3
		     WHEN IFNULL(ROUND(TT2.rank/(SELECT COUNT(*) FROM TB_HOLDER_SUMMARY)*100,1),0) &gt;= 15 THEN 2
		     ELSE 1 END) AS CORE_AVE_VALUE
		,(TT1.CHAR_UNITY_VALUE+TT1.CHAR_CARE_VALUE+TT1.CHAR_TRUTH_VALUE) AS STD_ALL_VALUE111
		,(
		CASE WHEN (TT1.CHAR_UNITY_VALUE+TT1.CHAR_CARE_VALUE+TT1.CHAR_TRUTH_VALUE) &gt;= 11 THEN 4
		     WHEN (TT1.CHAR_UNITY_VALUE+TT1.CHAR_CARE_VALUE+TT1.CHAR_TRUTH_VALUE) &gt;= 9 THEN 3
		     ELSE 2 END) AS STD_ALL_VALUE
		FROM
		(SELECT CHAR_UNITY
		,CHAR_CARE
		,CHAR_TRUTH
		,TOTAL_SIMILAR
		,PERSONALITY_SIMILAR
		,WORTH_SIMILAR
		,STEN_ANS
		,(CASE WHEN IFNULL(CHAR_UNITY,0) = 'A' THEN 4
		     WHEN IFNULL(CHAR_UNITY,0) = 'B' THEN 3
		     WHEN IFNULL(CHAR_UNITY,0) = 'C' THEN 2
		     ELSE 0 END) AS CHAR_UNITY_VALUE
		,(CASE WHEN IFNULL(CHAR_CARE,0) = 'A' THEN 4
		     WHEN IFNULL(CHAR_CARE,0) = 'B' THEN 3
		     WHEN IFNULL(CHAR_CARE,0) = 'C' THEN 2
		     ELSE 0 END) AS CHAR_CARE_VALUE
		,(CASE WHEN IFNULL(CHAR_TRUTH,0) = 'A' THEN 4
		     WHEN IFNULL(CHAR_TRUTH,0) = 'B' THEN 3
		     WHEN IFNULL(CHAR_TRUTH,0) = 'C' THEN 2
		     ELSE 0 END) AS CHAR_TRUTH_VALUE
		,responder_id
		FROM TB_SURVEY_SUMMARY where recruit_survey_id = #{recruit_survey_id} AND RESponder_id = #{responder_id}) TT1 
		JOIN 
		(
		SELECT responder_id 
		,(
		    SELECT COUNT( * )
		    FROM TB_HOLDER_SUMMARY
		    WHERE (STEN_VA1+STEN_VA2+STEN_VA3+STEN_VA4)/4 &lt; T1.CORE_AVE
		) AS rank
		FROM TB_SURVEY_SUMMARY T1 where T1.RECRUIT_SURVEY_ID = #{recruit_survey_id} and T1.SUMMARY_STEP = 7 
		ORDER BY CORE_AVE
		) AS TT2 ON TT1.responder_id = TT2.responder_id
		) TTT1
	</select>
	
	<!-- 설문중 설문요약 내용 호출 -->
	<select id="getMySurveySummaryView" parameterType="box" resultType="box">
		SELECT 
		    summary_step
		    , summary_page
		FROM TB_SURVEY_SUMMARY
		WHERE RECRUIT_SURVEY_ID = #{s_recruit_survey_id}
		AND RESPONDER_ID = #{s_responder_id}
	</select>
	
	<!-- 설문 Insert -->
	<insert id="surveySummaryInsert" parameterType="box">
	   INSERT INTO TB_SURVEY_SUMMARY (
		   	recruit_survey_id
		   	,responder_id
		   	, summary_step
		    , summary_page
		   	,reg_id
		   	,reg_dt
		   	,edit_id
		   	,edit_dt
	   	)VALUES (
		   	#{recruit_survey_id}
		   	,#{responder_id}
		   	,3
		   	,3
		   	,#{mem_id}
		   	,now()
		   	,#{mem_id}
		   	,now()
	   	)
	</insert>
	
	<!-- 설문 Update -->
	<update id="mySurveySummaryUpdate" parameterType="box" >
		 UPDATE TB_SURVEY_SUMMARY set 
		   recruit_survey_id = #{s_recruit_survey_id}
		   	<if test="summary_step != null and summary_step != '' ">
		   	, summary_step = #{summary_step}
		   	</if>
		   	<if test="summary_page != null and summary_page != '' ">
		   	, summary_page = #{summary_page}
		   	</if>
		   	<if test="summary_step != null and summary_step == 7 ">
		   	, complete_dt = now()
		   	</if>
		   	, edit_id = #{mem_id}
		    , edit_dt = now()
	    WHERE RECRUIT_SURVEY_ID = #{s_recruit_survey_id}
	    AND RESPONDER_ID = #{s_responder_id}
	</update>
	
	<!-- 설문 Update -->
	<update id="surveySummaryUpdate" parameterType="box" >
	   UPDATE TB_SURVEY_SUMMARY set
		   va1 = #{va1}
		   , va2 = #{va2}
		   , va3 = #{va3}
		   , va4 = #{va4}
		   , pos = #{pos}
		   , neg = #{neg}
		   , iso = #{iso}
		   , pas = #{pas}
		   , rkt = #{rkt}
		   , ect = #{ect}
		   , nar = #{nar}
		   , pow = #{pow}
		   , sst = #{sst}
		   , ats = #{ats}
		   , rul = #{rul}
		   , mor = #{mor}
		   , dpr = #{dpr}
		   , anx = #{anx}
		   , ins = #{ins}
		   , sten_va1 = #{sten_va1}
		   , sten_va2 = #{sten_va2}
		   , sten_va3 = #{sten_va3}
		   , sten_va4 = #{sten_va4}
		   , sten_pos = #{sten_pos}
		   , sten_neg = #{sten_neg}
		   , sten_iso = #{sten_iso}
		   , sten_pas = #{sten_pas}
		   , sten_rkt = #{sten_rkt}
		   , sten_ect = #{sten_ect}
		   , sten_nar = #{sten_nar}
		   , sten_pow = #{sten_pow}
		   , sten_sst = #{sten_sst}
		   , sten_ats = #{sten_ats}
		   , sten_rul = #{sten_rul}
		   , sten_mor = #{sten_mor}
		   , level_dpr = #{level_dpr}
		   , level_anx = #{level_anx}
		   , level_ins = #{level_ins}
		   , char_unity = #{char_unity}
		   , char_care = #{char_care}
		   , char_truth = #{char_truth}
		   , core_ave = #{core_ave}
		   , std_iso = #{std_iso}
		   , std_pas = #{std_pas}
		   , std_rkt = #{std_rkt}
		   , std_ect = #{std_ect}
		   , std_nar = #{std_nar}
		   , std_pow = #{std_pow}
		   , std_sst = #{std_sst}
		   , std_ats = #{std_ats}
		   , std_all = #{std_all}
		   , sten_ans = #{sten_ans}
		   , edit_id = #{mem_id}
		   , edit_dt = now()
	   WHERE RECRUIT_SURVEY_ID = #{recruit_survey_id}
	   AND RESPONDER_ID = #{responder_id}
	</update>
	
	<!-- 설문 Delete -->
	<delete id="surveySummaryDelete" parameterType="box">
	   DELETE FROM TB_SURVEY_SUMMARY
	   WHERE RECRUIT_SURVEY_ID = #{recruit_survey_id}
	   AND RESPONDER_ID = #{responder_id}
	</delete>
	
	<!-- 설문 Delete -->
	<delete id="surveySummaryDelete2" parameterType="box">
	   DELETE FROM TB_SURVEY_SUMMARY
	   WHERE RESPONDER_ID = #{id}
	</delete>
	
	<!-- 설문통계조회 -->
	<select id="selectSurveyStatisticsList" parameterType="box" resultType="box">
		SELECT 
			TT3.id as id
				,ROUND(IFNULL(TT3.VA1_VALUE2,0),2) AS va1 <!-- 원점수_신뢰기반소통 -->
				,ROUND(IFNULL(TT3.VA2_VALUE2,0),2) AS va2  <!-- 원점수_독보적전문성 --> 
				,ROUND(IFNULL(TT3.VA3_VALUE2,0),2) AS va3  <!-- 원점수_진취적도전 -->
				,ROUND(IFNULL(TT3.VA4_VALUE2,0),2) AS va4  <!-- 원점수_창의적융합 --> 
				,ROUND(IFNULL(TT3.POS_VALUE2,0),2) AS pos  <!-- 원점수_긍정정서 -->
				,ROUND(IFNULL(TT3.NEG_VALUE2,0),2) AS neg <!-- 원점수_부정정서 --> 
				,ROUND(IFNULL(TT3.ISO_VALUE2,0),2) AS iso <!-- 원점수_사교(고립성) -->
				,ROUND(IFNULL(TT3.PAS_VALUE2,0),2) AS pas <!-- 원점수_외향(회피성) -->
				,ROUND(IFNULL(TT3.RKT_VALUE2,0),2) AS rkt <!-- 원점수_적극(수동성) -->
				,ROUND(IFNULL(TT3.ECT_VALUE2,0),2) AS ect <!-- 원점수_융화(특이성) -->
				,ROUND(IFNULL(TT3.NAR_VALUE2,0),2) AS nar <!-- 원점수_존중(우월의식) -->
				,ROUND(IFNULL(TT3.POW_VALUE2,0),2) AS pow <!-- 원점수_민주(권위의식) -->
				,ROUND(IFNULL(TT3.SST_VALUE2,0),2) AS sst <!-- 원점수_평등(성차별적) -->
				,ROUND(IFNULL(TT3.ATS_VALUE2,0),2) AS ats <!-- 원점수_우호(반사회성) -->
				,ROUND(IFNULL(TT3.RUL_VALUE2,0),2) AS rul <!-- 원점수_원칙준수 -->
				,ROUND(IFNULL(TT3.MOR_VALUE2,0),2) AS mor <!-- 원점수_도덕성 --> 
				,ROUND(IFNULL(TT3.DPR_VALUE2,0),2) AS dpr <!-- 원점수_우울 -->
				,ROUND(IFNULL(TT3.ANX_VALUE2,0),2) AS anx <!-- 원점수_불안 --> 
				,ROUND(IFNULL(TT3.INS_VALUE2,0),2) AS ins <!-- 원점수_불면 -->
				,ROUND(IFNULL(TT3.ISO_VALUE3,0),2) AS std_iso <!-- STD_사교 --> 
				,ROUND(IFNULL(TT3.PAS_VALUE3,0),2) AS std_pas <!-- STD_외향 -->
				,ROUND(IFNULL(TT3.RKT_VALUE3,0),2) AS std_rkt <!-- STD_적극 --> 
				,ROUND(IFNULL(TT3.ECT_VALUE3,0),2) AS std_ect <!-- STD_융화 -->
				,ROUND(IFNULL(TT3.NAR_VALUE3,0),2) AS std_nar <!-- STD_존중 --> 
				,ROUND(IFNULL(TT3.POW_VALUE3,0),2) AS std_pow <!-- STD_민주 -->
				,ROUND(IFNULL(TT3.SST_VALUE3,0),2) AS std_sst <!-- STD_평등 --> 
				,ROUND(IFNULL(TT3.ATS_VALUE3,0),2) AS std_ats <!-- STD_우호 --> 
				,ROUND(IFNULL(TT3.STD_ALL,0),2) AS std_all <!-- STD_전체 -->
				,ROUND(IFNULL(TT3.STEN_VA1,0),2) AS sten_va1 <!-- STEN_신뢰기반소통 -->
				,ROUND(IFNULL(TT3.STEN_VA2,0),2) AS sten_va2 <!-- STEN_독보적전문성 -->
				,ROUND(IFNULL(TT3.STEN_VA3,0),2) AS sten_va3 <!-- STEN_진취적도전 --> 
				,ROUND(IFNULL(TT3.STEN_VA4,0),2) AS sten_va4 <!-- STEN_창의적융합 -->
				,ROUND(IFNULL(TT3.STEN_POSITIVE,0),2) AS  sten_pos <!-- SCORE_정서상태 --> 
				,ROUND(IFNULL(TT3.LEVEL_POS,0),2) AS sten_neg <!-- LEVEL_정서상태 -->
				,ROUND(IFNULL(TT3.STEN_ISO,0),2) AS sten_iso <!-- STEN_사교(고립성) -->
				,ROUND(IFNULL(TT3.STEN_PAS,0),2) AS sten_pas <!-- STEN_외향(회피성) -->
				,ROUND(IFNULL(TT3.STEN_RKT,0),2) AS sten_rkt <!-- STEN_적극(수동성) -->
				,ROUND(IFNULL(TT3.STEN_ECT,0),2) AS sten_ect <!-- STEN_융화(특이성) -->
				,ROUND(IFNULL(TT3.STEN_NAR,0),2) AS sten_nar <!-- STEN_존중(우월의식) -->
				,ROUND(IFNULL(TT3.STEN_POW,0),2) AS sten_pow <!-- STEN_민주(권위의식) -->
				,ROUND(IFNULL(TT3.STEN_SST,0),2) AS sten_sst <!-- STEN_평등(성차별적) -->
				,ROUND(IFNULL(TT3.STEN_ATS,0),2) AS sten_ats <!-- STEN_우호(반사회성) -->
				,ROUND(IFNULL(TT3.STEN_RUL,0),2) AS sten_rul <!-- STEN_원칙준수 --> 
				,ROUND(IFNULL(TT3.STEN_MOR,0),2) AS sten_mor <!-- STEN_도덕성 -->
				,ROUND(IFNULL(TT3.LEVEL_DPR,0),2) AS level_dpr <!-- LEVEL_우울 -->
				,ROUND(IFNULL(TT3.LEVEL_ANX,0),2) AS level_anx <!-- LEVEL_불안 --> 
				,ROUND(IFNULL(TT3.LEVEL_INS,0),2) AS level_ins <!-- LEVEL_불면 -->
				,(CASE WHEN TT3.STEN_ISO &lt; 1.5 OR TT3.STEN_PAS &lt; 1.5 OR TT3.STEN_RKT &lt; 1.5 THEN 'F'
						 WHEN (TT3.STEN_ISO + TT3.STEN_PAS + TT3.STEN_RKT + TT3.STEN_ECT)/4 &gt;= 6.5 THEN 'A'
						 WHEN (TT3.STEN_ISO + TT3.STEN_PAS + TT3.STEN_RKT + TT3.STEN_ECT)/4 &gt;= 4.5 THEN 'B'
						 ELSE 'C' END
				) AS char_unity <!-- 인성_인화 --> 
				,(CASE WHEN TT3.STEN_SST &lt; 1.5 OR TT3.STEN_ATS &lt; 1.5 THEN 'F'
						 WHEN (TT3.STEN_POW + TT3.STEN_NAR + TT3.STEN_SST + TT3.STEN_ATS)/4 &gt;= 6.5 THEN 'A'
						 WHEN (TT3.STEN_POW + TT3.STEN_NAR + TT3.STEN_SST + TT3.STEN_ATS)/4 &gt;= 4.5 THEN 'B'
						 ELSE 'C' END
				) AS char_care <!-- 인성_배려 --> 
				,(CASE WHEN (TT3.STEN_RUL + TT3.STEN_MOR)/2 &gt;= 6.5 THEN 'A'
						 WHEN (TT3.STEN_RUL + TT3.STEN_MOR)/2 &gt;= 4.5 THEN 'B'
						 ELSE 'C' END
				) AS char_truth <!-- 인성_정직 -->
				,((TT3.STEN_VA1 + TT3.STEN_VA2 + TT3.STEN_VA3 + TT3.STEN_VA4)/4) AS core_ave <!-- 핵심가치_평균 -->
				,(CASE WHEN (5.5+(2*(TT3.STD_ALL - TT3.AVERAGE_STD_ALL))/TT3.STDDEV_STD_ALL) &gt; 10 THEN 10
					    WHEN (5.5+(2*(TT3.STD_ALL - TT3.AVERAGE_STD_ALL))/TT3.STDDEV_STD_ALL) &lt; 1 THEN 1
					    ELSE (5.5+(2*(TT3.STD_ALL - TT3.AVERAGE_STD_ALL))/TT3.STDDEV_STD_ALL) END
				 ) AS sten_ans <!-- STEN_응답비일관성 -->
			FROM (
				SELECT 
				TT1.ID
				,TT1.VA1_VALUE2 <!-- 원점수_신뢰기반소통 --> 
				,TT1.VA2_VALUE2 <!-- 원점수_독보적전문성 -->
				,TT1.VA3_VALUE2 <!-- 원점수_진취적도전 --> 
				,TT1.VA4_VALUE2 <!-- 원점수_창의적융합 --> 
				,TT1.POS_VALUE2 <!-- 원점수_긍정정서 -->
				,TT1.NEG_VALUE2 <!-- 원점수_부정정서 -->
				,TT1.ISO_VALUE2 <!-- 원점수_사교(고립성) -->
				,TT1.PAS_VALUE2 <!-- 원점수_외향(회피성) -->
				,TT1.RKT_VALUE2 <!-- 원점수_적극(수동성) -->
				,TT1.ECT_VALUE2 <!-- 원점수_융화(특이성) -->
				,TT1.NAR_VALUE2 <!-- 원점수_존중(우월의식) -->
				,TT1.POW_VALUE2 <!-- 원점수_민주(권위의식) -->
				,TT1.SST_VALUE2 <!-- 원점수_평등(성차별적) -->
				,TT1.ATS_VALUE2 <!-- 원점수_우호(반사회성) -->
				,TT1.RUL_VALUE2 <!-- 원점수_원칙준수 --> 
				,TT1.MOR_VALUE2 <!-- 원점수_도덕성 --> 
				,TT1.DPR_VALUE2 <!-- 원점수_우울 --> 
				,TT1.ANX_VALUE2 <!-- 원점수_불안 --> 
				,TT1.INS_VALUE2 <!-- 원점수_불면 --> 
				,TT1.ISO_VALUE3  <!-- STD_사교 --> 
				,TT1.PAS_VALUE3  <!-- STD_외향 --> 
				,TT1.RKT_VALUE3  <!-- STD_적극 -->
				,TT1.ECT_VALUE3  <!-- STD_융화 --> 
				,TT1.NAR_VALUE3  <!-- STD_존중 --> 
				,TT1.POW_VALUE3 <!-- STD_민주 --> 
				,TT1.SST_VALUE3 <!-- STD_평등 --> 
				,TT1.ATS_VALUE3 <!-- STD_우호 -->
				,((TT1.ISO_VALUE3 + TT1.PAS_VALUE3 + TT1.RKT_VALUE3 + TT1.ECT_VALUE3 + TT1.NAR_VALUE3 + TT1.POW_VALUE3 + TT1.SST_VALUE3 + TT1.ATS_VALUE3) / 8 ) AS STD_ALL <!-- STD_전체 -->
				,(CASE WHEN (5.5 + (2*((TT1.VA1_VALUE2 - 2.86554149085794)/0.633374337532813))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA1_VALUE2 - 2.86554149085794)/0.633374337532813))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA1_VALUE2 - 2.86554149085794)/0.633374337532813))) END ) AS STEN_VA1 <!-- STEN_신뢰기반소통 --> 
				,(CASE WHEN (5.5 + (2*((TT1.VA2_VALUE2 - 2.52119750853928)/0.523934076891863))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA2_VALUE2 - 2.52119750853928)/0.523934076891863))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA2_VALUE2 - 2.52119750853928)/0.523934076891863))) END ) AS STEN_VA2 <!-- STEN_독보적전문성 -->
				,(CASE WHEN (5.5 + (2*((TT1.VA3_VALUE2 - 2.5159734779988)/0.456905772257725))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA3_VALUE2 - 2.5159734779988)/0.456905772257725))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA3_VALUE2 - 2.5159734779988)/0.456905772257725))) END ) AS STEN_VA3 <!-- STEN_진취적도전 --> 
				,(CASE WHEN (5.5 + (2*((TT1.VA4_VALUE2 - 2.1221870604782)/0.584678946596246))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA4_VALUE2 - 2.1221870604782)/0.584678946596246))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA4_VALUE2 - 2.1221870604782)/0.584678946596246))) END ) AS STEN_VA4 <!-- STEN_창의적융합 --> 
				, (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) AS STEN_POSITIVE  <!-- SCORE_정서상태  -->
				,(CASE WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0.75 THEN 4
						 WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0.5 THEN 3
						 WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0.25 THEN 2
						 WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0 THEN 1
						 ELSE 0 END
				) AS LEVEL_POS <!-- LEVEL_정서상태 -->
				,(CASE WHEN (5.5 + (2*((TT1.ISO_VALUE2 - 4.6080637599625)/0.862542000518371))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.ISO_VALUE2 - 4.6080637599625)/0.862542000518371))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.ISO_VALUE2 - 4.6080637599625)/0.862542000518371))) END ) AS STEN_ISO <!-- STEN_사교(고립성) -->
				,(CASE WHEN (5.5 + (2*((TT1.PAS_VALUE2 - 3.76887013595874)/1.07679746956744))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.PAS_VALUE2 - 3.76887013595874)/1.07679746956744))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.PAS_VALUE2 - 3.76887013595874)/1.07679746956744))) END ) AS STEN_PAS <!-- STEN_외향(회피성) -->
				,(CASE WHEN (5.5 + (2*((TT1.RKT_VALUE2 - 3.54512423816221)/0.589475759273982))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.RKT_VALUE2 - 3.54512423816221)/0.589475759273982))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.RKT_VALUE2 - 3.54512423816221)/0.589475759273982))) END ) AS STEN_RKT <!-- STEN_적극(수동성) -->
				,(CASE WHEN (5.5 + (2*((TT1.ECT_VALUE2 - 4.32594936708861)/0.904136607976583))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.ECT_VALUE2 - 4.32594936708861)/0.904136607976583))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.ECT_VALUE2 - 4.32594936708861)/0.904136607976583))) END ) AS STEN_ECT <!-- STEN_융화(특이성) -->
				,(CASE WHEN (5.5 + (2*((TT1.NAR_VALUE2 - 4.07876230661041)/0.796748949476998))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.NAR_VALUE2 - 4.07876230661041)/0.796748949476998))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.NAR_VALUE2 - 4.07876230661041)/0.796748949476998))) END ) AS STEN_NAR <!-- STEN_존중(우월의식) -->
				,(CASE WHEN (5.5 + (2*((TT1.POW_VALUE2 - 2.95030473511486)/0.946470000877612))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.POW_VALUE2 - 2.95030473511486)/0.946470000877612))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.POW_VALUE2 - 2.95030473511486)/0.946470000877612))) END ) AS STEN_POW <!-- STEN_민주(권위의식) -->
				,(CASE WHEN (5.5 + (2*((TT1.SST_VALUE2 - 4.20370370370371)/0.869561994883392))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.SST_VALUE2 - 4.20370370370371)/0.869561994883392))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.SST_VALUE2 - 4.20370370370371)/0.869561994883392))) END ) AS STEN_SST  <!-- STEN_평등(성차별적) -->
				,(CASE WHEN (5.5 + (2*((TT1.ATS_VALUE2 - 4.32489451476793)/0.686174450253824))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.ATS_VALUE2 - 4.32489451476793)/0.686174450253824))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.ATS_VALUE2 - 4.32489451476793)/0.686174450253824))) END ) AS STEN_ATS <!-- STEN_우호(반사회성) -->
				,(CASE WHEN (5.5 + (2*((TT1.RUL_VALUE2 - 3.4462962962963)/0.805525722138348))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.RUL_VALUE2 - 3.4462962962963)/0.805525722138348))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.RUL_VALUE2 - 3.4462962962963)/0.805525722138348))) END ) AS STEN_RUL <!-- STEN_원칙준수 --> 
				,(CASE WHEN (5.5 + (2*((TT1.MOR_VALUE2 - 3.45308641975309)/0.670397769222939))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.MOR_VALUE2 - 3.45308641975309)/0.670397769222939))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.MOR_VALUE2 - 3.45308641975309)/0.670397769222939))) END ) AS STEN_MOR <!-- STEN_도덕성 -->
				,(CASE WHEN TT1.DPR_VALUE2 &gt;= 18 THEN 3
						 WHEN TT1.DPR_VALUE2 &gt;= 13 THEN 2
						 ELSE 1 END
				) AS LEVEL_DPR <!-- LEVEL_우울 --> 
				,(CASE WHEN TT1.ANX_VALUE2 &gt;= 18 THEN 3
						 WHEN TT1.ANX_VALUE2 &gt;= 11 THEN 2
						 ELSE 1 END
				) AS LEVEL_ANX <!-- LEVEL_불안 --> 
				,(CASE WHEN TT1.INS_VALUE2 &gt;= 8 THEN 3
						 WHEN TT1.INS_VALUE2 &gt;= 6 THEN 2
						 ELSE 1 END
				) AS LEVEL_INS <!-- LEVEL_불면 --> 
				,0.880113329147506 AS AVERAGE_STD_ALL 
				,0.232616603974601 AS STDDEV_STD_ALL
				 FROM (
					SELECT T5.ID
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA1_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA2_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA3_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA4_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POS' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS POS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NEG' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS NEG_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ISO_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS PAS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RKT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ECT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS NAR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS POW_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS SST_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ATS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RUL_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS MOR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS DPR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ANX_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS INS_VALUE2
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS ISO_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS PAS_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS RKT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS ECT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS NAR_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS POW_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS SST_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS ATS_VALUE3
					FROM SV_RECRUIT_SURVEY T0
					INNER JOIN TB_SURVEY T1 ON T1.ID = T0.SURVEY_ID
					INNER JOIN TB_INQUIRY T2 ON T1.ID = T2.SURVEY_ID
					INNER JOIN TB_INQUIRY_ITEM T3 ON T2.ID = T3.INQUIRY_ID
					INNER JOIN TB_ITEM_ANSWER T4 ON T3.ID = T4.ITEM_ID AND CONFIRM_YN = 'Y'
					INNER JOIN SV_USER T5 ON T4.RESPONDER_ID = T5.ID
					INNER JOIN TB_SURVEY_SUMMARY T6 ON T5.ID = T6.RESPONDER_ID 
					WHERE T0.ID = #{s_recruit_survey_id}
					AND T6.SUMMARY_STEP = 7
					AND T3.ESTIMATION_YN = 'Y'
					GROUP BY T5.ID
				) TT1 JOIN (
					SELECT 
					 COUNT(*) AS ALL_CNT
					 ,SUM(TT1.VA1_VALUE2) AS SUM_VA1_VALUE2
					 ,STDDEV_SAMP(TT1.VA1_VALUE2) AS STDDEV_VA1_VALUE2
					 ,SUM(TT1.VA2_VALUE2) AS SUM_VA2_VALUE2
					 ,STDDEV_SAMP(TT1.VA2_VALUE2) AS STDDEV_VA2_VALUE2	 
					 ,SUM(TT1.VA3_VALUE2) AS SUM_VA3_VALUE2
					 ,STDDEV_SAMP(TT1.VA3_VALUE2) AS STDDEV_VA3_VALUE2	 
					 ,SUM(TT1.VA4_VALUE2) AS SUM_VA4_VALUE2
					 ,STDDEV_SAMP(TT1.VA4_VALUE2) AS STDDEV_VA4_VALUE2	
					 ,SUM(TT1.ISO_VALUE2) AS SUM_ISO_VALUE2
					 ,STDDEV_SAMP(TT1.ISO_VALUE2) AS STDDEV_ISO_VALUE2	
					 ,SUM(TT1.PAS_VALUE2) AS SUM_PAS_VALUE2
					 ,STDDEV_SAMP(TT1.PAS_VALUE2) AS STDDEV_PAS_VALUE2	
					 ,SUM(TT1.RKT_VALUE2) AS SUM_RKT_VALUE2
					 ,STDDEV_SAMP(TT1.RKT_VALUE2) AS STDDEV_RKT_VALUE2	
					 ,SUM(TT1.ECT_VALUE2) AS SUM_ECT_VALUE2
					 ,STDDEV_SAMP(TT1.ECT_VALUE2) AS STDDEV_ECT_VALUE2	
					 ,SUM(TT1.NAR_VALUE2) AS SUM_NAR_VALUE2
					 ,STDDEV_SAMP(TT1.NAR_VALUE2) AS STDDEV_NAR_VALUE2	
					 ,SUM(TT1.POW_VALUE2) AS SUM_POW_VALUE2
					 ,STDDEV_SAMP(TT1.POW_VALUE2) AS STDDEV_POW_VALUE2	
					 ,SUM(TT1.SST_VALUE2) AS SUM_SST_VALUE2
					 ,STDDEV_SAMP(TT1.SST_VALUE2) AS STDDEV_SST_VALUE2
					 ,SUM(TT1.ATS_VALUE2) AS SUM_ATS_VALUE2
					 ,STDDEV_SAMP(TT1.ATS_VALUE2) AS STDDEV_ATS_VALUE2
					 ,SUM(TT1.RUL_VALUE2) AS SUM_RUL_VALUE2
					 ,STDDEV_SAMP(TT1.RUL_VALUE2) AS STDDEV_RUL_VALUE2
					 ,SUM(TT1.MOR_VALUE2) AS SUM_MOR_VALUE2
					 ,STDDEV_SAMP(TT1.MOR_VALUE2) AS STDDEV_MOR_VALUE2
					 ,(SUM((TT1.ISO_VALUE3 + TT1.PAS_VALUE3 + TT1.RKT_VALUE3 + TT1.ECT_VALUE3 + TT1.NAR_VALUE3 + TT1.POW_VALUE3 + TT1.SST_VALUE3 + TT1.ATS_VALUE3) / 8 )/COUNT(*)) AS AVERAGE_STD_ALL
					 ,STDDEV_SAMP((TT1.ISO_VALUE3 + TT1.PAS_VALUE3 + TT1.RKT_VALUE3 + TT1.ECT_VALUE3 + TT1.NAR_VALUE3 + TT1.POW_VALUE3 + TT1.SST_VALUE3 + TT1.ATS_VALUE3) / 8) AS STDDEV_STD_ALL
					FROM (
						SELECT T5.ID
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA1_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA2_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA3_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA4_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POS' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS POS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NEG' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS NEG_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ISO_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS PAS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RKT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ECT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS NAR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS POW_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS SST_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ATS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RUL_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS MOR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS DPR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ANX_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS INS_VALUE2
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS ISO_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS PAS_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS RKT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS ECT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS NAR_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS POW_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS SST_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) END)) AS ATS_VALUE3
						FROM SV_RECRUIT_SURVEY T0
						INNER JOIN TB_SURVEY T1 ON T1.ID = T0.SURVEY_ID
						INNER JOIN TB_INQUIRY T2 ON T1.ID = T2.SURVEY_ID
						INNER JOIN TB_INQUIRY_ITEM T3 ON T2.ID = T3.INQUIRY_ID
						INNER JOIN TB_ITEM_ANSWER T4 ON T3.ID = T4.ITEM_ID AND CONFIRM_YN = 'Y'
						INNER JOIN SV_USER T5 ON T4.RESPONDER_ID = T5.ID
						INNER JOIN TB_SURVEY_SUMMARY T6 ON T5.ID = T6.RESPONDER_ID 
						WHERE T0.ID = #{s_recruit_survey_id}
						AND T6.SUMMARY_STEP = 7
						AND T3.ESTIMATION_YN = 'Y'
						GROUP BY T5.ID
						) TT1
				) TT2
			)TT3
	</select>
	
	<!-- 설문통계조회 -->
	<select id="selectSurveyStatisticsList_original" parameterType="box" resultType="box">
		SELECT 
			TT3.id as id
				,ROUND(IFNULL(TT3.VA1_VALUE2,0),2) AS va1 <!-- 원점수_신뢰기반소통 -->
				,ROUND(IFNULL(TT3.VA2_VALUE2,0),2) AS va2  <!-- 원점수_독보적전문성 --> 
				,ROUND(IFNULL(TT3.VA3_VALUE2,0),2) AS va3  <!-- 원점수_진취적도전 -->
				,ROUND(IFNULL(TT3.VA4_VALUE2,0),2) AS va4  <!-- 원점수_창의적융합 --> 
				,ROUND(IFNULL(TT3.POS_VALUE2,0),2) AS pos  <!-- 원점수_긍정정서 -->
				,ROUND(IFNULL(TT3.NEG_VALUE2,0),2) AS neg <!-- 원점수_부정정서 --> 
				,ROUND(IFNULL(TT3.ISO_VALUE2,0),2) AS iso <!-- 원점수_사교(고립성) -->
				,ROUND(IFNULL(TT3.PAS_VALUE2,0),2) AS pas <!-- 원점수_외향(회피성) -->
				,ROUND(IFNULL(TT3.RKT_VALUE2,0),2) AS rkt <!-- 원점수_적극(수동성) -->
				,ROUND(IFNULL(TT3.ECT_VALUE2,0),2) AS ect <!-- 원점수_융화(특이성) -->
				,ROUND(IFNULL(TT3.NAR_VALUE2,0),2) AS nar <!-- 원점수_존중(우월의식) -->
				,ROUND(IFNULL(TT3.POW_VALUE2,0),2) AS pow <!-- 원점수_민주(권위의식) -->
				,ROUND(IFNULL(TT3.SST_VALUE2,0),2) AS sst <!-- 원점수_평등(성차별적) -->
				,ROUND(IFNULL(TT3.ATS_VALUE2,0),2) AS ats <!-- 원점수_우호(반사회성) -->
				,ROUND(IFNULL(TT3.RUL_VALUE2,0),2) AS rul <!-- 원점수_원칙준수 -->
				,ROUND(IFNULL(TT3.MOR_VALUE2,0),2) AS mor <!-- 원점수_도덕성 --> 
				,ROUND(IFNULL(TT3.DPR_VALUE2,0),2) AS dpr <!-- 원점수_우울 -->
				,ROUND(IFNULL(TT3.ANX_VALUE2,0),2) AS anx <!-- 원점수_불안 --> 
				,ROUND(IFNULL(TT3.INS_VALUE2,0),2) AS ins <!-- 원점수_불면 -->
				,ROUND(IFNULL(TT3.ISO_VALUE3,0),2) AS std_iso <!-- STD_사교 --> 
				,ROUND(IFNULL(TT3.PAS_VALUE3,0),2) AS std_pas <!-- STD_외향 -->
				,ROUND(IFNULL(TT3.RKT_VALUE3,0),2) AS std_rkt <!-- STD_적극 --> 
				,ROUND(IFNULL(TT3.ECT_VALUE3,0),2) AS std_ect <!-- STD_융화 -->
				,ROUND(IFNULL(TT3.NAR_VALUE3,0),2) AS std_nar <!-- STD_존중 --> 
				,ROUND(IFNULL(TT3.POW_VALUE3,0),2) AS std_pow <!-- STD_민주 -->
				,ROUND(IFNULL(TT3.SST_VALUE3,0),2) AS std_sst <!-- STD_평등 --> 
				,ROUND(IFNULL(TT3.ATS_VALUE3,0),2) AS std_ats <!-- STD_우호 --> 
				,ROUND(IFNULL(TT3.STD_ALL,0),2) AS std_all <!-- STD_전체 -->
				,ROUND(IFNULL(TT3.STEN_VA1,0),2) AS sten_va1 <!-- STEN_신뢰기반소통 -->
				,ROUND(IFNULL(TT3.STEN_VA2,0),2) AS sten_va2 <!-- STEN_독보적전문성 -->
				,ROUND(IFNULL(TT3.STEN_VA3,0),2) AS sten_va3 <!-- STEN_진취적도전 --> 
				,ROUND(IFNULL(TT3.STEN_VA4,0),2) AS sten_va4 <!-- STEN_창의적융합 -->
				,ROUND(IFNULL(TT3.STEN_POSITIVE,0),2) AS  sten_pos <!-- SCORE_정서상태 --> 
				,ROUND(IFNULL(TT3.LEVEL_POS,0),2) AS sten_neg <!-- LEVEL_정서상태 -->
				,ROUND(IFNULL(TT3.STEN_ISO,0),2) AS sten_iso <!-- STEN_사교(고립성) -->
				,ROUND(IFNULL(TT3.STEN_PAS,0),2) AS sten_pas <!-- STEN_외향(회피성) -->
				,ROUND(IFNULL(TT3.STEN_RKT,0),2) AS sten_rkt <!-- STEN_적극(수동성) -->
				,ROUND(IFNULL(TT3.STEN_ECT,0),2) AS sten_ect <!-- STEN_융화(특이성) -->
				,ROUND(IFNULL(TT3.STEN_NAR,0),2) AS sten_nar <!-- STEN_존중(우월의식) -->
				,ROUND(IFNULL(TT3.STEN_POW,0),2) AS sten_pow <!-- STEN_민주(권위의식) -->
				,ROUND(IFNULL(TT3.STEN_SST,0),2) AS sten_sst <!-- STEN_평등(성차별적) -->
				,ROUND(IFNULL(TT3.STEN_ATS,0),2) AS sten_ats <!-- STEN_우호(반사회성) -->
				,ROUND(IFNULL(TT3.STEN_RUL,0),2) AS sten_rul <!-- STEN_원칙준수 --> 
				,ROUND(IFNULL(TT3.STEN_MOR,0),2) AS sten_mor <!-- STEN_도덕성 -->
				,ROUND(IFNULL(TT3.LEVEL_DPR,0),2) AS level_dpr <!-- LEVEL_우울 -->
				,ROUND(IFNULL(TT3.LEVEL_ANX,0),2) AS level_anx <!-- LEVEL_불안 --> 
				,ROUND(IFNULL(TT3.LEVEL_INS,0),2) AS level_ins <!-- LEVEL_불면 -->
				,(CASE WHEN TT3.STEN_ISO &lt; 1.5 OR TT3.STEN_PAS &lt; 1.5 OR TT3.STEN_RKT &lt; 1.5 THEN 'F'
						 WHEN (TT3.STEN_ISO + TT3.STEN_PAS + TT3.STEN_RKT + TT3.STEN_ECT)/4 &gt;= 6.5 THEN 'A'
						 WHEN (TT3.STEN_ISO + TT3.STEN_PAS + TT3.STEN_RKT + TT3.STEN_ECT)/4 &gt;= 4.5 THEN 'B'
						 ELSE 'C' END
				) AS char_unity <!-- 인성_인화 --> 
				,(CASE WHEN TT3.STEN_SST &lt; 1.5 OR TT3.STEN_ATS &lt; 1.5 THEN 'F'
						 WHEN (TT3.STEN_POW + TT3.STEN_NAR + TT3.STEN_SST + TT3.STEN_ATS)/4 &gt;= 6.5 THEN 'A'
						 WHEN (TT3.STEN_POW + TT3.STEN_NAR + TT3.STEN_SST + TT3.STEN_ATS)/4 &gt;= 4.5 THEN 'B'
						 ELSE 'C' END
				) AS char_care <!-- 인성_배려 --> 
				,(CASE WHEN (TT3.STEN_RUL + TT3.STEN_MOR)/2 &gt;= 6.5 THEN 'A'
						 WHEN (TT3.STEN_RUL + TT3.STEN_MOR)/2 &gt;= 4.5 THEN 'B'
						 ELSE 'C' END
				) AS char_truth <!-- 인성_정직 -->
				,((TT3.STEN_VA1 + TT3.STEN_VA2 + TT3.STEN_VA3 + TT3.STEN_VA4)/4) AS core_ave <!-- 핵심가치_평균 -->
				,(CASE WHEN (5.5+(2*(TT3.STD_ALL - TT3.AVERAGE_STD_ALL))/TT3.STDDEV_STD_ALL) &gt; 10 THEN 10
					    WHEN (5.5+(2*(TT3.STD_ALL - TT3.AVERAGE_STD_ALL))/TT3.STDDEV_STD_ALL) &lt; 1 THEN 1
					    ELSE (5.5+(2*(TT3.STD_ALL - TT3.AVERAGE_STD_ALL))/TT3.STDDEV_STD_ALL) END
				 ) AS sten_ans <!-- STEN_응답비일관성 -->
			FROM (
				SELECT 
				TT1.ID
				,TT1.VA1_VALUE2 <!-- 원점수_신뢰기반소통 --> 
				,TT1.VA2_VALUE2 <!-- 원점수_독보적전문성 -->
				,TT1.VA3_VALUE2 <!-- 원점수_진취적도전 --> 
				,TT1.VA4_VALUE2 <!-- 원점수_창의적융합 --> 
				,TT1.POS_VALUE2 <!-- 원점수_긍정정서 -->
				,TT1.NEG_VALUE2 <!-- 원점수_부정정서 -->
				,TT1.ISO_VALUE2 <!-- 원점수_사교(고립성) -->
				,TT1.PAS_VALUE2 <!-- 원점수_외향(회피성) -->
				,TT1.RKT_VALUE2 <!-- 원점수_적극(수동성) -->
				,TT1.ECT_VALUE2 <!-- 원점수_융화(특이성) -->
				,TT1.NAR_VALUE2 <!-- 원점수_존중(우월의식) -->
				,TT1.POW_VALUE2 <!-- 원점수_민주(권위의식) -->
				,TT1.SST_VALUE2 <!-- 원점수_평등(성차별적) -->
				,TT1.ATS_VALUE2 <!-- 원점수_우호(반사회성) -->
				,TT1.RUL_VALUE2 <!-- 원점수_원칙준수 --> 
				,TT1.MOR_VALUE2 <!-- 원점수_도덕성 --> 
				,TT1.DPR_VALUE2 <!-- 원점수_우울 --> 
				,TT1.ANX_VALUE2 <!-- 원점수_불안 --> 
				,TT1.INS_VALUE2 <!-- 원점수_불면 --> 
				,TT1.ISO_VALUE3  <!-- STD_사교 --> 
				,TT1.PAS_VALUE3  <!-- STD_외향 --> 
				,TT1.RKT_VALUE3  <!-- STD_적극 -->
				,TT1.ECT_VALUE3  <!-- STD_융화 --> 
				,TT1.NAR_VALUE3  <!-- STD_존중 --> 
				,TT1.POW_VALUE3 <!-- STD_민주 --> 
				,TT1.SST_VALUE3 <!-- STD_평등 --> 
				,TT1.ATS_VALUE3 <!-- STD_우호 -->
				,((TT1.ISO_VALUE3 + TT1.PAS_VALUE3 + TT1.RKT_VALUE3 + TT1.ECT_VALUE3 + TT1.NAR_VALUE3 + TT1.POW_VALUE3 + TT1.SST_VALUE3 + TT1.ATS_VALUE3) / 8 ) AS STD_ALL <!-- STD_전체 -->
				,(CASE WHEN (5.5 + (2*((TT1.VA1_VALUE2 - TT2.SUM_VA1_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA1_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA1_VALUE2 - TT2.SUM_VA1_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA1_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA1_VALUE2 - TT2.SUM_VA1_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA1_VALUE2))) END ) AS STEN_VA1 <!-- STEN_신뢰기반소통 --> 
				,(CASE WHEN (5.5 + (2*((TT1.VA2_VALUE2 - TT2.SUM_VA2_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA2_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA2_VALUE2 - TT2.SUM_VA2_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA2_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA2_VALUE2 - TT2.SUM_VA2_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA2_VALUE2))) END ) AS STEN_VA2 <!-- STEN_독보적전문성 -->
				,(CASE WHEN (5.5 + (2*((TT1.VA3_VALUE2 - TT2.SUM_VA3_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA3_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA3_VALUE2 - TT2.SUM_VA3_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA3_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA3_VALUE2 - TT2.SUM_VA3_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA3_VALUE2))) END ) AS STEN_VA3 <!-- STEN_진취적도전 --> 
				,(CASE WHEN (5.5 + (2*((TT1.VA4_VALUE2 - TT2.SUM_VA4_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA4_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.VA4_VALUE2 - TT2.SUM_VA4_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA4_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.VA4_VALUE2 - TT2.SUM_VA4_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_VA4_VALUE2))) END ) AS STEN_VA4 <!-- STEN_창의적융합 --> 
				, (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) AS STEN_POSITIVE  <!-- SCORE_정서상태  -->
				,(CASE WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0.75 THEN 4
						 WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0.5 THEN 3
						 WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0.25 THEN 2
						 WHEN (TT1.POS_VALUE2 / (TT1.POS_VALUE2 + TT1.NEG_VALUE2)) &gt;= 0 THEN 1
						 ELSE 0 END
				) AS LEVEL_POS <!-- LEVEL_정서상태 -->
				,(CASE WHEN (5.5 + (2*((TT1.ISO_VALUE2 - TT2.SUM_ISO_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ISO_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.ISO_VALUE2 - TT2.SUM_ISO_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ISO_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.ISO_VALUE2 - TT2.SUM_ISO_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ISO_VALUE2))) END ) AS STEN_ISO <!-- STEN_사교(고립성) -->
				,(CASE WHEN (5.5 + (2*((TT1.PAS_VALUE2 - TT2.SUM_PAS_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_PAS_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.PAS_VALUE2 - TT2.SUM_PAS_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_PAS_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.PAS_VALUE2 - TT2.SUM_PAS_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_PAS_VALUE2))) END ) AS STEN_PAS <!-- STEN_외향(회피성) -->
				,(CASE WHEN (5.5 + (2*((TT1.RKT_VALUE2 - TT2.SUM_RKT_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_RKT_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.RKT_VALUE2 - TT2.SUM_RKT_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_RKT_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.RKT_VALUE2 - TT2.SUM_RKT_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_RKT_VALUE2))) END ) AS STEN_RKT <!-- STEN_적극(수동성) -->
				,(CASE WHEN (5.5 + (2*((TT1.ECT_VALUE2 - TT2.SUM_ECT_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ECT_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.ECT_VALUE2 - TT2.SUM_ECT_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ECT_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.ECT_VALUE2 - TT2.SUM_ECT_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ECT_VALUE2))) END ) AS STEN_ECT <!-- STEN_융화(특이성) -->
				,(CASE WHEN (5.5 + (2*((TT1.NAR_VALUE2 - TT2.SUM_NAR_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_NAR_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.NAR_VALUE2 - TT2.SUM_NAR_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_NAR_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.NAR_VALUE2 - TT2.SUM_NAR_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_NAR_VALUE2))) END ) AS STEN_NAR <!-- STEN_존중(우월의식) -->
				,(CASE WHEN (5.5 + (2*((TT1.POW_VALUE2 - TT2.SUM_POW_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_POW_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.POW_VALUE2 - TT2.SUM_POW_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_POW_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.POW_VALUE2 - TT2.SUM_POW_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_POW_VALUE2))) END ) AS STEN_POW <!-- STEN_민주(권위의식) -->
				,(CASE WHEN (5.5 + (2*((TT1.SST_VALUE2 - TT2.SUM_SST_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_SST_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.SST_VALUE2 - TT2.SUM_SST_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_SST_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.SST_VALUE2 - TT2.SUM_SST_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_SST_VALUE2))) END ) AS STEN_SST  <!-- STEN_평등(성차별적) -->
				,(CASE WHEN (5.5 + (2*((TT1.ATS_VALUE2 - TT2.SUM_ATS_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ATS_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.ATS_VALUE2 - TT2.SUM_ATS_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ATS_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.ATS_VALUE2 - TT2.SUM_ATS_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_ATS_VALUE2))) END ) AS STEN_ATS <!-- STEN_우호(반사회성) -->
				,(CASE WHEN (5.5 + (2*((TT1.RUL_VALUE2 - TT2.SUM_RUL_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_RUL_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.RUL_VALUE2 - TT2.SUM_RUL_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_RUL_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.RUL_VALUE2 - TT2.SUM_RUL_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_RUL_VALUE2))) END ) AS STEN_RUL <!-- STEN_원칙준수 --> 
				,(CASE WHEN (5.5 + (2*((TT1.MOR_VALUE2 - TT2.SUM_MOR_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_MOR_VALUE2))) &gt; 10 THEN 10
					  WHEN (5.5 + (2*((TT1.MOR_VALUE2 - TT2.SUM_MOR_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_MOR_VALUE2))) &lt; 1 THEN 1
					  ELSE (5.5 + (2*((TT1.MOR_VALUE2 - TT2.SUM_MOR_VALUE2/TT2.ALL_CNT) / TT2.STDDEV_MOR_VALUE2))) END ) AS STEN_MOR <!-- STEN_도덕성 -->
				,(CASE WHEN TT1.DPR_VALUE2 &gt;= 18 THEN 3
						 WHEN TT1.DPR_VALUE2 &gt;= 13 THEN 2
						 ELSE 1 END
				) AS LEVEL_DPR <!-- LEVEL_우울 --> 
				,(CASE WHEN TT1.ANX_VALUE2 &gt;= 18 THEN 3
						 WHEN TT1.ANX_VALUE2 &gt;= 11 THEN 2
						 ELSE 1 END
				) AS LEVEL_ANX <!-- LEVEL_불안 --> 
				,(CASE WHEN TT1.INS_VALUE2 &gt;= 8 THEN 3
						 WHEN TT1.INS_VALUE2 &gt;= 6 THEN 2
						 ELSE 1 END
				) AS LEVEL_INS <!-- LEVEL_불면 --> 
				,0.880113329147506 AS AVERAGE_STD_ALL 
				,0.232616603974601 AS STDDEV_STD_ALL
				 FROM (
					SELECT T5.ID
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA1_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA2_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA3_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA4_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POS' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS POS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NEG' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS NEG_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ISO_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS PAS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RKT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ECT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS NAR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS POW_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS SST_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ATS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RUL_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS MOR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS DPR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ANX_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS INS_VALUE2
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ISO_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS PAS_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS RKT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ECT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS NAR_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS POW_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS SST_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ATS_VALUE3
					FROM TB_SURVEY T1
					INNER JOIN TB_INQUIRY T2 ON T1.ID = T2.SURVEY_ID
					INNER JOIN TB_INQUIRY_ITEM T3 ON T2.ID = T3.INQUIRY_ID
					INNER JOIN TB_ITEM_ANSWER T4 ON T3.ID = T4.ITEM_ID AND CONFIRM_YN = 'Y'
					INNER JOIN SV_USER T5 ON T4.RESPONDER_ID = T5.ID
					INNER JOIN TB_SURVEY_SUMMARY T6 ON T5.ID = T6.RESPONDER_ID 
					WHERE T1.ID = #{s_survey_id}
					AND T6.SUMMARY_STEP = 7
					GROUP BY T5.ID
				) TT1 JOIN (
					SELECT 
					 COUNT(*) AS ALL_CNT
					 ,SUM(TT1.VA1_VALUE2) AS SUM_VA1_VALUE2
					 ,STDDEV_SAMP(TT1.VA1_VALUE2) AS STDDEV_VA1_VALUE2
					 ,SUM(TT1.VA2_VALUE2) AS SUM_VA2_VALUE2
					 ,STDDEV_SAMP(TT1.VA2_VALUE2) AS STDDEV_VA2_VALUE2	 
					 ,SUM(TT1.VA3_VALUE2) AS SUM_VA3_VALUE2
					 ,STDDEV_SAMP(TT1.VA3_VALUE2) AS STDDEV_VA3_VALUE2	 
					 ,SUM(TT1.VA4_VALUE2) AS SUM_VA4_VALUE2
					 ,STDDEV_SAMP(TT1.VA4_VALUE2) AS STDDEV_VA4_VALUE2	
					 ,SUM(TT1.ISO_VALUE2) AS SUM_ISO_VALUE2
					 ,STDDEV_SAMP(TT1.ISO_VALUE2) AS STDDEV_ISO_VALUE2	
					 ,SUM(TT1.PAS_VALUE2) AS SUM_PAS_VALUE2
					 ,STDDEV_SAMP(TT1.PAS_VALUE2) AS STDDEV_PAS_VALUE2	
					 ,SUM(TT1.RKT_VALUE2) AS SUM_RKT_VALUE2
					 ,STDDEV_SAMP(TT1.RKT_VALUE2) AS STDDEV_RKT_VALUE2	
					 ,SUM(TT1.ECT_VALUE2) AS SUM_ECT_VALUE2
					 ,STDDEV_SAMP(TT1.ECT_VALUE2) AS STDDEV_ECT_VALUE2	
					 ,SUM(TT1.NAR_VALUE2) AS SUM_NAR_VALUE2
					 ,STDDEV_SAMP(TT1.NAR_VALUE2) AS STDDEV_NAR_VALUE2	
					 ,SUM(TT1.POW_VALUE2) AS SUM_POW_VALUE2
					 ,STDDEV_SAMP(TT1.POW_VALUE2) AS STDDEV_POW_VALUE2	
					 ,SUM(TT1.SST_VALUE2) AS SUM_SST_VALUE2
					 ,STDDEV_SAMP(TT1.SST_VALUE2) AS STDDEV_SST_VALUE2
					 ,SUM(TT1.ATS_VALUE2) AS SUM_ATS_VALUE2
					 ,STDDEV_SAMP(TT1.ATS_VALUE2) AS STDDEV_ATS_VALUE2
					 ,SUM(TT1.RUL_VALUE2) AS SUM_RUL_VALUE2
					 ,STDDEV_SAMP(TT1.RUL_VALUE2) AS STDDEV_RUL_VALUE2
					 ,SUM(TT1.MOR_VALUE2) AS SUM_MOR_VALUE2
					 ,STDDEV_SAMP(TT1.MOR_VALUE2) AS STDDEV_MOR_VALUE2
					 ,(SUM((TT1.ISO_VALUE3 + TT1.PAS_VALUE3 + TT1.RKT_VALUE3 + TT1.ECT_VALUE3 + TT1.NAR_VALUE3 + TT1.POW_VALUE3 + TT1.SST_VALUE3 + TT1.ATS_VALUE3) / 8 )/COUNT(*)) AS AVERAGE_STD_ALL
					 ,STDDEV_SAMP((TT1.ISO_VALUE3 + TT1.PAS_VALUE3 + TT1.RKT_VALUE3 + TT1.ECT_VALUE3 + TT1.NAR_VALUE3 + TT1.POW_VALUE3 + TT1.SST_VALUE3 + TT1.ATS_VALUE3) / 8) AS STDDEV_STD_ALL
					FROM (
						SELECT T5.ID
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA1' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA1_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA2' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA2_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA3' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA3_VALUE2
						,(5 - SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'VA4' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS VA4_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POS' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS POS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NEG' AND T3.ESTIMATION_YN = 'Y' THEN IFNULL(T4.ANSWER_NO,0) ELSE 0 END) - 8) AS NEG_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ISO_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS PAS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RKT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ECT_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS NAR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS POW_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS SST_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS ATS_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'RUL' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS RUL_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)/SUM(CASE WHEN T3.ITEM_TYPE = 'MOR' AND T3.ESTIMATION_YN = 'Y' THEN 1 ELSE 0 END)) AS MOR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'DPR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS DPR_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ANX' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ANX_VALUE2
						,(SUM(CASE WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'INS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 6 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS INS_VALUE2
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ISO' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ISO_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'PAS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS PAS_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'RKT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS RKT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ECT' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ECT_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'NAR' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS NAR_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'POW' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS POW_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'SST' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS SST_VALUE3
						,(STDDEV_SAMP(CASE WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'N' THEN IFNULL(T4.ANSWER_NO,0) WHEN T3.ITEM_TYPE = 'ATS' AND T3.ESTIMATION_YN = 'Y' AND T3.REVERSE_SCORE_YN = 'Y' THEN 7 - IFNULL(T4.ANSWER_NO,0) ELSE 0 END)) AS ATS_VALUE3
						FROM TB_SURVEY T1
						INNER JOIN TB_INQUIRY T2 ON T1.ID = T2.SURVEY_ID
						INNER JOIN TB_INQUIRY_ITEM T3 ON T2.ID = T3.INQUIRY_ID
						INNER JOIN TB_ITEM_ANSWER T4 ON T3.ID = T4.ITEM_ID AND CONFIRM_YN = 'Y'
						INNER JOIN SV_USER T5 ON T4.RESPONDER_ID = T5.ID
						INNER JOIN TB_SURVEY_SUMMARY T6 ON T5.ID = T6.RESPONDER_ID 
						WHERE T1.ID = #{s_survey_id}
						AND T6.SUMMARY_STEP = 7
						GROUP BY T5.ID
						) TT1
				) TT2
			)TT3
	</select>
	
	<!-- 설문EXCEL출력 -->
	<select id="selectSurveySummaryExcelList" parameterType="box" resultType="box">
		SELECT
			TT1.recruit_survey_id
		    , TT1.responder_id
		    , TT0.recruit_nm as recruit_survey_nm
		    , TT2.user_nm
		    , TT2.email
		    , TT4.code_nm as company_nm
		    , TT2.area
		    , TT5.code_nm as belong_nm
		    , TT6.code_nm as position_nm
		    , TT7.code_nm as job_nm
		    , TT8.code_nm as duty_nm
		    , TT9.code_nm as gender_nm
		    , TT10.code_nm as recruit_nm
			,TT0.no1
			,TT0.no2
			,TT0.no3
			,TT0.no4
			,TT0.no5
			,TT0.no6
			,TT0.no7
			,TT0.no8
			,TT0.no9
			,TT0.no10
			,TT0.no11
			,TT0.no12
			,TT0.no13
			,TT0.no14
			,TT0.no15
			,TT0.no16
			,TT0.no17
			,TT0.no18
			,TT0.no19
			,TT0.no20
			,TT0.no21
			,TT0.no22
			,TT0.no23
			,TT0.no24
			,TT0.no25
			,TT0.no26
			,TT0.no27
			,TT0.no28
			,TT0.no29
			,TT0.no30
			,TT0.no31
			,TT0.no32
			,TT0.no33
			,TT0.no34
			,TT0.no35
			,TT0.no36
			,TT0.no37
			,TT0.no38
			,TT0.no39
			,TT0.no40
			,TT0.no41
			,TT0.no42
			,TT0.no43
			,TT0.no44
			,TT0.no45
			,TT0.no46
			,TT0.no47
			,TT0.no48
			,TT0.no49
			,TT0.no50
			,TT0.no51
			,TT0.no52
			,TT0.no53
			,TT0.no54
			,TT0.no55
			,TT0.no56
			,TT0.no57
			,TT0.no58
			,TT0.no59
			,TT0.no60
			,TT0.no61
			,TT0.no62
			,TT0.no63
			,TT0.no64
			,TT0.no65
			,TT0.no66
			,TT0.no67
			,TT0.no68
			,TT0.no69
			,TT0.no70
			,TT0.no71
			,TT0.no72
			,TT0.no73
			,TT0.no74
			,TT0.no75
			,TT0.no76
			,TT0.no77
			,TT0.no78
			,TT0.no79
			,TT0.no80
			,TT0.no81
			,TT0.no82
			,TT0.no83
			,TT0.no84
			,TT0.no85
			,TT0.no86
			,TT0.no87
			,TT0.no88
			,TT0.no89
			,TT0.no90
			,TT0.no91
			,TT0.no92
			,TT0.no93
			,TT0.no94
			,TT0.no95
			,TT0.no96
			,TT0.no97
			,TT0.no98
			,TT0.no99
			,TT0.no100
			,TT0.no101
			,TT0.no102
			,TT0.no103
			,TT0.no104
			,TT0.no105
			,TT0.no106
			,TT0.no107
			,TT0.no108
			,TT0.no109
			,TT0.no110
			,TT0.no111
			,TT0.no112
			,TT0.no113
			,TT0.no114
			,TT0.no115
			,TT0.no116
			,TT0.no117
			,TT0.no118
			,TT0.no119
			,TT0.no120
			,TT0.no121
			,TT0.no122
			,TT0.no123
			,TT0.no124
			,TT0.no125
			,TT0.no126
			,TT0.no127
			,TT0.no128
			,TT0.no129
			,TT0.no130
			,TT0.no131
			,TT0.no132
			,TT0.no133
			,TT0.no134
			,TT0.no135
			,TT0.no136
			,TT0.no137
			,TT0.no138
			,TT0.no139
			,TT0.no140
			,TT0.no141
			,TT0.no142
			,TT0.no143
			,TT0.no144
			,TT0.no145
			,TT0.no146
			,TT0.no147
			,TT0.no148
			,TT0.no149
			,TT0.no150
			,TT0.no151
			,TT0.no152
			,TT0.no153
			,TT0.no154
			,TT0.no155
			,TT0.no156
			,TT0.no157
			,TT0.no158
			,TT0.no159
			,TT0.no160
			,TT0.no161
			,TT0.no162
			,TT0.no163
			,TT0.no164
			,TT0.no165
			,TT0.no166
			,TT0.no167
			,TT0.no168
			,TT0.no169
			,TT0.no170
			,TT0.no171
			,TT0.no172
			,TT0.no173
			,TT0.no174
			,TT0.no175
			,TT0.no176
			,TT0.no177
			,TT0.no178
			,TT0.no179
			,TT0.no180
			,TT0.no181
			,TT0.no182
			,TT0.no183
			,TT0.no184
			,TT0.no185
			,TT0.no186
			,TT0.no187
			,TT0.no188
			,TT0.no189
			,TT0.no190
			,TT0.no191
			,TT0.no192
			,TT0.no193
			,TT0.no194
			,TT0.no195
			,TT0.no196
			,TT0.no197
			,TT0.no198
			,TT0.no199
			,TT0.no200
			,TT0.no201
			,TT0.no202
			,TT0.no203
			,TT0.no204
			,TT0.no205
			,TT0.no206
			,TT0.no207
			,TT0.no208
			,TT0.no209
			,TT0.no210
			,TT0.no211
			,TT0.no212
			,TT0.no213
			,TT0.no214
			,TT0.no215
			,TT0.no216
			,TT0.no217
			,TT0.no218
			,TT0.no219
			,TT0.no220
			,TT0.no221
			,TT0.no222
			,TT0.no223
			,TT0.no224
			,TT0.no225
			,TT0.no226
			,TT0.no227
			,TT0.no228
			,TT0.no229
			,TT0.no230
			,TT0.no231
			,TT0.no232
			,TT0.no233
			,TT0.no234
			,TT0.no235
			,TT0.no236
			,TT0.no237
			,TT0.no238
			,TT0.no239
			,TT0.no240
			,TT0.no241
			,TT0.no242
			,TT0.no243
			,TT0.no244
			,TT0.no245
			,TT0.no246
			,TT0.no247
			,TT0.no248
			,TT0.no249
			,TT0.no250
		    , TT1.va1
		    , TT1.va2
		    , TT1.va3
		    , TT1.va4
		    , TT1.pos
		    , TT1.neg
		    , TT1.iso 
		    , TT1.pas
		    , TT1.rkt
		    , TT1.ect
		    , TT1.nar
		    , TT1.pow
		    , TT1.sst
		    , TT1.ats
		    , TT1.rul
		    , TT1.mor
		    , TT1.dpr
		    , TT1.anx
		    , TT1.ins
		    , TT1.sten_va1
		    , TT1.sten_va2
		    , TT1.sten_va3
		    , TT1.sten_va4
		    , TT1.sten_pos
		    , TT1.sten_neg
		    , TT1.sten_iso
		    , TT1.sten_pas
		    , TT1.sten_rkt
		    , TT1.sten_ect
		    , TT1.sten_nar
		    , TT1.sten_pow
		    , TT1.sten_sst
		    , TT1.sten_ats
		    , TT1.sten_rul
		    , TT1.sten_mor
		    , TT1.level_dpr
		    , TT1.level_anx
		    , TT1.level_ins
		    , (CASE WHEN LEVEL_DPR = 1 THEN '양호'
				       WHEN LEVEL_DPR = 2 THEN '주의'
					   WHEN LEVEL_DPR = 3 THEN '심각'
					   ELSE '' END
			) AS dpr_txt <!-- 우울 -->
			, (CASE WHEN LEVEL_ANX = 1 THEN '양호'
			       WHEN LEVEL_ANX = 2 THEN '주의'
				   WHEN LEVEL_ANX = 3 THEN '심각'
				   ELSE '' END
			) AS anx_txt <!-- 불안  -->
			, (CASE WHEN LEVEL_INS = 1 THEN '양호'
			       WHEN LEVEL_INS = 2 THEN '주의'
				   WHEN LEVEL_INS = 3 THEN '심각'
				   ELSE '' END
			) AS ins_txt <!-- 불면 -->
		    , TT1.char_unity
		    , TT1.char_care
		    , TT1.char_truth
		    , TT1.core_ave
		    , TT1.std_iso
		    , TT1.std_pas
		    , TT1.std_rkt
		    , TT1.std_ect
		    , TT1.std_nar
		    , TT1.std_pow
		    , TT1.std_sst
		    , TT1.std_ats
		    , TT1.std_all
		    , TT1.sten_ans
		    , TT1.worth
		    , TT1.personality
		    , TT1.worth_similar
		    , TT1.personality_similar
		    , TT1.total_similar
		    , TT1.similar_rank
			, TT1.reg_id
			, DATE_FORMAT(TT1.reg_dt, '%Y-%m-%d') as reg_dt
			, TT1.edit_id
			, DATE_FORMAT(TT1.edit_dt, '%Y-%m-%d') as edit_dt
		FROM
			(SELECT T0.ID,T0.RECRUIT_NM,T3.SURVEY_ID,T1.RESPONDER_ID
				,MAX(CASE WHEN T2.COL_NO = 1 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO1
				,MAX(CASE WHEN T2.COL_NO = 2 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO2
				,MAX(CASE WHEN T2.COL_NO = 3 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO3
				,MAX(CASE WHEN T2.COL_NO = 4 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO4
				,MAX(CASE WHEN T2.COL_NO = 5 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO5
				,MAX(CASE WHEN T2.COL_NO = 6 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO6
				,MAX(CASE WHEN T2.COL_NO = 7 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO7
				,MAX(CASE WHEN T2.COL_NO = 8 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO8
				,MAX(CASE WHEN T2.COL_NO = 9 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO9
				,MAX(CASE WHEN T2.COL_NO = 10 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO10
				
				,MAX(CASE WHEN T2.COL_NO = 11 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO11
				,MAX(CASE WHEN T2.COL_NO = 12 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO12
				,MAX(CASE WHEN T2.COL_NO = 13 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO13
				,MAX(CASE WHEN T2.COL_NO = 14 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO14
				,MAX(CASE WHEN T2.COL_NO = 15 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO15
				,MAX(CASE WHEN T2.COL_NO = 16 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO16
				,MAX(CASE WHEN T2.COL_NO = 17 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO17
				,MAX(CASE WHEN T2.COL_NO = 18 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO18
				,MAX(CASE WHEN T2.COL_NO = 19 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO19
				,MAX(CASE WHEN T2.COL_NO = 20 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO20
				
				,MAX(CASE WHEN T2.COL_NO = 21 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO21
				,MAX(CASE WHEN T2.COL_NO = 22 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO22
				,MAX(CASE WHEN T2.COL_NO = 23 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO23
				,MAX(CASE WHEN T2.COL_NO = 24 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO24
				,MAX(CASE WHEN T2.COL_NO = 25 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO25
				,MAX(CASE WHEN T2.COL_NO = 26 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO26
				,MAX(CASE WHEN T2.COL_NO = 27 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO27
				,MAX(CASE WHEN T2.COL_NO = 28 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO28
				,MAX(CASE WHEN T2.COL_NO = 29 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO29
				,MAX(CASE WHEN T2.COL_NO = 30 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO30
				
				,MAX(CASE WHEN T2.COL_NO = 31 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO31
				,MAX(CASE WHEN T2.COL_NO = 32 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO32
				,MAX(CASE WHEN T2.COL_NO = 33 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO33
				,MAX(CASE WHEN T2.COL_NO = 34 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO34
				,MAX(CASE WHEN T2.COL_NO = 35 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO35
				,MAX(CASE WHEN T2.COL_NO = 36 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO36
				,MAX(CASE WHEN T2.COL_NO = 37 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO37
				,MAX(CASE WHEN T2.COL_NO = 38 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO38
				,MAX(CASE WHEN T2.COL_NO = 39 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO39
				,MAX(CASE WHEN T2.COL_NO = 40 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO40
				
				,MAX(CASE WHEN T2.COL_NO = 41 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO41
				,MAX(CASE WHEN T2.COL_NO = 42 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO42
				,MAX(CASE WHEN T2.COL_NO = 43 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO43
				,MAX(CASE WHEN T2.COL_NO = 44 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO44
				,MAX(CASE WHEN T2.COL_NO = 45 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO45
				,MAX(CASE WHEN T2.COL_NO = 46 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO46
				,MAX(CASE WHEN T2.COL_NO = 47 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO47
				,MAX(CASE WHEN T2.COL_NO = 48 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO48
				,MAX(CASE WHEN T2.COL_NO = 49 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO49
				,MAX(CASE WHEN T2.COL_NO = 50 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO50
				
				,MAX(CASE WHEN T2.COL_NO = 51 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO51
				,MAX(CASE WHEN T2.COL_NO = 52 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO52
				,MAX(CASE WHEN T2.COL_NO = 53 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO53
				,MAX(CASE WHEN T2.COL_NO = 54 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO54
				,MAX(CASE WHEN T2.COL_NO = 55 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO55
				,MAX(CASE WHEN T2.COL_NO = 56 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO56
				,MAX(CASE WHEN T2.COL_NO = 57 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO57
				,MAX(CASE WHEN T2.COL_NO = 58 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO58
				,MAX(CASE WHEN T2.COL_NO = 59 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO59
				,MAX(CASE WHEN T2.COL_NO = 60 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO60
				
				,MAX(CASE WHEN T2.COL_NO = 61 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO61
				,MAX(CASE WHEN T2.COL_NO = 62 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO62
				,MAX(CASE WHEN T2.COL_NO = 63 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO63
				,MAX(CASE WHEN T2.COL_NO = 64 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO64
				,MAX(CASE WHEN T2.COL_NO = 65 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO65
				,MAX(CASE WHEN T2.COL_NO = 66 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO66
				,MAX(CASE WHEN T2.COL_NO = 67 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO67
				,MAX(CASE WHEN T2.COL_NO = 68 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO68
				,MAX(CASE WHEN T2.COL_NO = 69 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO69
				,MAX(CASE WHEN T2.COL_NO = 70 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO70
				
				,MAX(CASE WHEN T2.COL_NO = 71 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO71
				,MAX(CASE WHEN T2.COL_NO = 72 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO72
				,MAX(CASE WHEN T2.COL_NO = 73 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO73
				,MAX(CASE WHEN T2.COL_NO = 74 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO74
				,MAX(CASE WHEN T2.COL_NO = 75 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO75
				,MAX(CASE WHEN T2.COL_NO = 76 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO76
				,MAX(CASE WHEN T2.COL_NO = 77 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO77
				,MAX(CASE WHEN T2.COL_NO = 78 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO78
				,MAX(CASE WHEN T2.COL_NO = 79 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO79
				,MAX(CASE WHEN T2.COL_NO = 80 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO80
				
				,MAX(CASE WHEN T2.COL_NO = 81 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO81
				,MAX(CASE WHEN T2.COL_NO = 82 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO82
				,MAX(CASE WHEN T2.COL_NO = 83 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO83
				,MAX(CASE WHEN T2.COL_NO = 84 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO84
				,MAX(CASE WHEN T2.COL_NO = 85 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO85
				,MAX(CASE WHEN T2.COL_NO = 86 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO86
				,MAX(CASE WHEN T2.COL_NO = 87 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO87
				,MAX(CASE WHEN T2.COL_NO = 88 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO88
				,MAX(CASE WHEN T2.COL_NO = 89 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO89
				,MAX(CASE WHEN T2.COL_NO = 90 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO90
				
				,MAX(CASE WHEN T2.COL_NO = 91 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO91
				,MAX(CASE WHEN T2.COL_NO = 92 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO92
				,MAX(CASE WHEN T2.COL_NO = 93 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO93
				,MAX(CASE WHEN T2.COL_NO = 94 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO94
				,MAX(CASE WHEN T2.COL_NO = 95 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO95
				,MAX(CASE WHEN T2.COL_NO = 96 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO96
				,MAX(CASE WHEN T2.COL_NO = 97 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO97
				,MAX(CASE WHEN T2.COL_NO = 98 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO98
				,MAX(CASE WHEN T2.COL_NO = 99 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO99
				,MAX(CASE WHEN T2.COL_NO = 100 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO100
				
				,MAX(CASE WHEN T2.COL_NO = 101 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO101
				,MAX(CASE WHEN T2.COL_NO = 102 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO102
				,MAX(CASE WHEN T2.COL_NO = 103 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO103
				,MAX(CASE WHEN T2.COL_NO = 104 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO104
				,MAX(CASE WHEN T2.COL_NO = 105 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO105
				,MAX(CASE WHEN T2.COL_NO = 106 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO106
				,MAX(CASE WHEN T2.COL_NO = 107 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO107
				,MAX(CASE WHEN T2.COL_NO = 108 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO108
				,MAX(CASE WHEN T2.COL_NO = 109 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO109
				,MAX(CASE WHEN T2.COL_NO = 110 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO110
				
				,MAX(CASE WHEN T2.COL_NO = 111 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO111
				,MAX(CASE WHEN T2.COL_NO = 112 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO112
				,MAX(CASE WHEN T2.COL_NO = 113 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO113
				,MAX(CASE WHEN T2.COL_NO = 114 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO114
				,MAX(CASE WHEN T2.COL_NO = 115 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO115
				,MAX(CASE WHEN T2.COL_NO = 116 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO116
				,MAX(CASE WHEN T2.COL_NO = 117 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO117
				,MAX(CASE WHEN T2.COL_NO = 118 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO118
				,MAX(CASE WHEN T2.COL_NO = 119 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO119
				,MAX(CASE WHEN T2.COL_NO = 120 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO120
				
				,MAX(CASE WHEN T2.COL_NO = 121 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO121
				,MAX(CASE WHEN T2.COL_NO = 122 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO122
				,MAX(CASE WHEN T2.COL_NO = 123 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO123
				,MAX(CASE WHEN T2.COL_NO = 124 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO124
				,MAX(CASE WHEN T2.COL_NO = 125 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO125
				,MAX(CASE WHEN T2.COL_NO = 126 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO126
				,MAX(CASE WHEN T2.COL_NO = 127 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO127
				,MAX(CASE WHEN T2.COL_NO = 128 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO128
				,MAX(CASE WHEN T2.COL_NO = 129 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO129
				,MAX(CASE WHEN T2.COL_NO = 130 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO130
				
				,MAX(CASE WHEN T2.COL_NO = 131 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO131
				,MAX(CASE WHEN T2.COL_NO = 132 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO132
				,MAX(CASE WHEN T2.COL_NO = 133 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO133
				,MAX(CASE WHEN T2.COL_NO = 134 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO134
				,MAX(CASE WHEN T2.COL_NO = 135 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO135
				,MAX(CASE WHEN T2.COL_NO = 136 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO136
				,MAX(CASE WHEN T2.COL_NO = 137 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO137
				,MAX(CASE WHEN T2.COL_NO = 138 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO138
				,MAX(CASE WHEN T2.COL_NO = 139 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO139
				,MAX(CASE WHEN T2.COL_NO = 140 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO140
				
				,MAX(CASE WHEN T2.COL_NO = 141 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO141
				,MAX(CASE WHEN T2.COL_NO = 142 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO142
				,MAX(CASE WHEN T2.COL_NO = 143 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO143
				,MAX(CASE WHEN T2.COL_NO = 144 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO144
				,MAX(CASE WHEN T2.COL_NO = 145 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO145
				,MAX(CASE WHEN T2.COL_NO = 146 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO146
				,MAX(CASE WHEN T2.COL_NO = 147 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO147
				,MAX(CASE WHEN T2.COL_NO = 148 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO148
				,MAX(CASE WHEN T2.COL_NO = 149 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO149
				,MAX(CASE WHEN T2.COL_NO = 150 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO150
				
				,MAX(CASE WHEN T2.COL_NO = 151 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO151
				,MAX(CASE WHEN T2.COL_NO = 152 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO152
				,MAX(CASE WHEN T2.COL_NO = 153 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO153
				,MAX(CASE WHEN T2.COL_NO = 154 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO154
				,MAX(CASE WHEN T2.COL_NO = 155 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO155
				,MAX(CASE WHEN T2.COL_NO = 156 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO156
				,MAX(CASE WHEN T2.COL_NO = 157 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO157
				,MAX(CASE WHEN T2.COL_NO = 158 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO158
				,MAX(CASE WHEN T2.COL_NO = 159 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO159
				,MAX(CASE WHEN T2.COL_NO = 160 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO160
				
				,MAX(CASE WHEN T2.COL_NO = 161 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO161
				,MAX(CASE WHEN T2.COL_NO = 162 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO162
				,MAX(CASE WHEN T2.COL_NO = 163 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO163
				,MAX(CASE WHEN T2.COL_NO = 164 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO164
				,MAX(CASE WHEN T2.COL_NO = 165 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO165
				,MAX(CASE WHEN T2.COL_NO = 166 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO166
				,MAX(CASE WHEN T2.COL_NO = 167 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO167
				,MAX(CASE WHEN T2.COL_NO = 168 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO168
				,MAX(CASE WHEN T2.COL_NO = 169 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO169
				,MAX(CASE WHEN T2.COL_NO = 170 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO170
				
				,MAX(CASE WHEN T2.COL_NO = 171 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO171
				,MAX(CASE WHEN T2.COL_NO = 172 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO172
				,MAX(CASE WHEN T2.COL_NO = 173 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO173
				,MAX(CASE WHEN T2.COL_NO = 174 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO174
				,MAX(CASE WHEN T2.COL_NO = 175 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO175
				,MAX(CASE WHEN T2.COL_NO = 176 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO176
				,MAX(CASE WHEN T2.COL_NO = 177 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO177
				,MAX(CASE WHEN T2.COL_NO = 178 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO178
				,MAX(CASE WHEN T2.COL_NO = 179 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO179
				,MAX(CASE WHEN T2.COL_NO = 180 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO180
				
				,MAX(CASE WHEN T2.COL_NO = 181 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO181
				,MAX(CASE WHEN T2.COL_NO = 182 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO182
				,MAX(CASE WHEN T2.COL_NO = 183 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO183
				,MAX(CASE WHEN T2.COL_NO = 184 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO184
				,MAX(CASE WHEN T2.COL_NO = 185 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO185
				,MAX(CASE WHEN T2.COL_NO = 186 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO186
				,MAX(CASE WHEN T2.COL_NO = 187 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO187
				,MAX(CASE WHEN T2.COL_NO = 188 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO188
				,MAX(CASE WHEN T2.COL_NO = 189 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO189
				,MAX(CASE WHEN T2.COL_NO = 190 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO190
				
				,MAX(CASE WHEN T2.COL_NO = 191 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO191
				,MAX(CASE WHEN T2.COL_NO = 192 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO192
				,MAX(CASE WHEN T2.COL_NO = 193 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO193
				,MAX(CASE WHEN T2.COL_NO = 194 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO194
				,MAX(CASE WHEN T2.COL_NO = 195 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO195
				,MAX(CASE WHEN T2.COL_NO = 196 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO196
				,MAX(CASE WHEN T2.COL_NO = 197 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO197
				,MAX(CASE WHEN T2.COL_NO = 198 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO198
				,MAX(CASE WHEN T2.COL_NO = 199 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO199
				,MAX(CASE WHEN T2.COL_NO = 200 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO200
				
				,MAX(CASE WHEN T2.COL_NO = 201 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO201
				,MAX(CASE WHEN T2.COL_NO = 202 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO202
				,MAX(CASE WHEN T2.COL_NO = 203 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO203
				,MAX(CASE WHEN T2.COL_NO = 204 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO204
				,MAX(CASE WHEN T2.COL_NO = 205 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO205
				,MAX(CASE WHEN T2.COL_NO = 206 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO206
				,MAX(CASE WHEN T2.COL_NO = 207 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO207
				,MAX(CASE WHEN T2.COL_NO = 208 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO208
				,MAX(CASE WHEN T2.COL_NO = 209 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO209
				,MAX(CASE WHEN T2.COL_NO = 210 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO210
				
				,MAX(CASE WHEN T2.COL_NO = 211 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO211
				,MAX(CASE WHEN T2.COL_NO = 212 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO212
				,MAX(CASE WHEN T2.COL_NO = 213 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO213
				,MAX(CASE WHEN T2.COL_NO = 214 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO214
				,MAX(CASE WHEN T2.COL_NO = 215 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO215
				,MAX(CASE WHEN T2.COL_NO = 216 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO216
				,MAX(CASE WHEN T2.COL_NO = 217 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO217
				,MAX(CASE WHEN T2.COL_NO = 218 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO218
				,MAX(CASE WHEN T2.COL_NO = 219 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO219
				,MAX(CASE WHEN T2.COL_NO = 220 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO220
				
				,MAX(CASE WHEN T2.COL_NO = 221 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO221
				,MAX(CASE WHEN T2.COL_NO = 222 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO222
				,MAX(CASE WHEN T2.COL_NO = 223 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO223
				,MAX(CASE WHEN T2.COL_NO = 224 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO224
				,MAX(CASE WHEN T2.COL_NO = 225 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO225
				,MAX(CASE WHEN T2.COL_NO = 226 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO226
				,MAX(CASE WHEN T2.COL_NO = 227 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO227
				,MAX(CASE WHEN T2.COL_NO = 228 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO228
				,MAX(CASE WHEN T2.COL_NO = 229 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO229
				,MAX(CASE WHEN T2.COL_NO = 230 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO230
				
				,MAX(CASE WHEN T2.COL_NO = 231 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO231
				,MAX(CASE WHEN T2.COL_NO = 232 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO232
				,MAX(CASE WHEN T2.COL_NO = 233 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO233
				,MAX(CASE WHEN T2.COL_NO = 234 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO234
				,MAX(CASE WHEN T2.COL_NO = 235 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO235
				,MAX(CASE WHEN T2.COL_NO = 236 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO236
				,MAX(CASE WHEN T2.COL_NO = 237 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO237
				,MAX(CASE WHEN T2.COL_NO = 238 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO238
				,MAX(CASE WHEN T2.COL_NO = 239 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO239
				,MAX(CASE WHEN T2.COL_NO = 240 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO240
				
				,MAX(CASE WHEN T2.COL_NO = 241 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO241
				,MAX(CASE WHEN T2.COL_NO = 242 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO242
				,MAX(CASE WHEN T2.COL_NO = 243 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO243
				,MAX(CASE WHEN T2.COL_NO = 244 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO244
				,MAX(CASE WHEN T2.COL_NO = 245 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO245
				,MAX(CASE WHEN T2.COL_NO = 246 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO246
				,MAX(CASE WHEN T2.COL_NO = 247 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO247
				,MAX(CASE WHEN T2.COL_NO = 248 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO248
				,MAX(CASE WHEN T2.COL_NO = 249 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO249
				,MAX(CASE WHEN T2.COL_NO = 250 AND T1.ANSWER_NO IS NOT NULL THEN T1.ANSWER_NO ELSE -1 END ) AS NO250
				
				FROM TB_ITEM_ANSWER T1 INNER JOIN TB_INQUIRY_ITEM T2 ON T1.ITEM_ID = T2.ID
				INNER JOIN TB_INQUIRY T3 ON T2.INQUIRY_ID = T3.ID
				INNER JOIN SV_RECRUIT_SURVEY T0 ON T0.SURVEY_ID = T3.SURVEY_ID
				WHERE T0.ID = #{s_recruit_survey_id}
				GROUP BY T0.ID,T0.RECRUIT_NM,T3.SURVEY_ID,T1.RESPONDER_ID
				) TT0 
			LEFT OUTER JOIN TB_SURVEY_SUMMARY TT1 ON TT0.ID = TT1.RECRUIT_SURVEY_ID AND TT0.RESPONDER_ID = TT1.RESPONDER_ID
			INNER JOIN SV_USER TT2 ON TT1.RESPONDER_ID = TT2.ID
			LEFT OUTER JOIN SV_CODE TT4 ON TT4.UP_CODE = 'COMPANY' AND TT4.CODE = TT2.COMPANY_CODE
			LEFT OUTER JOIN SV_CODE TT5 ON TT5.UP_CODE = 'BELONG' AND TT5.CODE = TT2.BELONG_CODE
			LEFT OUTER JOIN SV_CODE TT6 ON TT6.UP_CODE = 'POSITION_TYPE' AND TT6.CODE = TT2.POSITION_CODE
			LEFT OUTER JOIN SV_CODE TT7 ON TT7.UP_CODE = 'JOB_TYPE' AND TT7.CODE = TT2.JOB_CODE
			LEFT OUTER JOIN SV_CODE TT8 ON TT8.UP_CODE = 'DUTY_TYPE' AND TT8.CODE = TT2.DUTY_CODE
			LEFT OUTER JOIN SV_CODE TT9 ON TT9.UP_CODE = 'GENDER_TYPE' AND TT9.CODE = TT2.GENDER_CODE
			LEFT OUTER JOIN SV_CODE TT10 ON TT10.UP_CODE = 'RECRUIT_TYPE' AND TT10.CODE = TT2.RECRUIT_CODE
			WHERE 1=1
		<include refid="summary_list_where"/>
		ORDER BY TT1.RECRUIT_SURVEY_ID DESC,TT1.REG_DT DESC
	</select>
	
	<!-- 설문 대표 Update -->
	<update id="surveySummaryRepresentativeUpdate" parameterType="box" >
	   UPDATE TB_SURVEY_SUMMARY set
		   worth = #{worth}
		   , personality = #{personality}
		   , worth_similar = #{worth_similar}
		   , personality_similar = #{personality_similar}
		   , total_similar = #{total_similar}
	   WHERE recruit_survey_id = #{recruit_survey_id}
	   AND RESPONDER_ID = #{responder_id}
	</update>
	
	<!-- 설문 대표 RANK Update -->
	<update id="surveySummaryRepresentativeUpdate2" parameterType="box" >
	   UPDATE TB_SURVEY_SUMMARY set
		   similar_rank = #{similar_rank}
		   , edit_id = #{mem_id}
		   , edit_dt = now()
	   WHERE recruit_survey_id = #{recruit_survey_id}
	   AND RESPONDER_ID = #{responder_id}
	</update>
	
	<!-- 대표구성원 유사도 생성 -->
	<select id="getSurveyRepresentativeList" parameterType="box" resultType="box">
		 SELECT TT3.recruit_survey_id
			,TT3.responder_id
			,TT3.worth
			,TT3.personality
		 FROM (
			SELECT 
			TT2.recruit_survey_id
			,TT2.responder_id
			,ROUND(SQRT(
			POWER((TT1.STEN_VA1-TT2.STEN_VA1),2)
			+POWER((TT1.STEN_VA2-TT2.STEN_VA2),2)
			+POWER((TT1.STEN_VA3-TT2.STEN_VA3),2)
			+POWER((TT1.STEN_VA4-TT2.STEN_VA4),2)
			),2) AS worth
			,ROUND(SQRT(
			POWER((TT1.STEN_ISO-TT2.STEN_ISO),2)
			+POWER((TT1.STEN_PAS-TT2.STEN_PAS),2)
			+POWER((TT1.STEN_RKT-TT2.STEN_RKT),2)
			+POWER((TT1.STEN_ECT-TT2.STEN_ECT),2)
			+POWER((TT1.STEN_NAR-TT2.STEN_NAR),2)
			+POWER((TT1.STEN_POW-TT2.STEN_POW),2)
			+POWER((TT1.STEN_SST-TT2.STEN_SST),2)
			+POWER((TT1.STEN_ATS-TT2.STEN_ATS),2)
			),2) AS personality
			FROM 
			(
			SELECT
			T0.recruit_survey_id
			, T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM SV_REPRESENTATIVE_USER T0 INNER JOIN TB_HOLDER_SUMMARY T1 ON T0.USER_ID = T1.RESPONDER_ID WHERE T0.RECRUIT_SURVEY_ID = #{s_recruit_survey_id}
			) TT1
			JOIN
			(SELECT
			T1.recruit_survey_id
			, T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso 
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_SURVEY_SUMMARY T1 WHERE T1.RECRUIT_SURVEY_ID = #{s_recruit_survey_id} AND T1.SUMMARY_STEP = 7) TT2
		 ) TT3 
	</select>
		
	<!-- 대표구성원 유사도 생성2 rank 입력 -->
	<select id="getSurveyRepresentativeList2" parameterType="box" resultType="box">
		 SELECT recruit_survey_id	,responder_id
		 FROM TB_SURVEY_SUMMARY WHERE RECRUIT_SURVEY_ID = #{s_recruit_survey_id}  
		 ORDER BY total_similar DESC
	</select>
	
	<!-- 대표구성원 유사도 최초 생성 참고용으로 남김  -->
	<select id="getSurveyRepresentativeList3" parameterType="box" resultType="box">
		 SELECT TT3.survey_id
			,TT3.responder_id
			,TT3.worth
			,TT3.personality
			,TT6.max_worth
			,TT6.max_personality
			,ROUND(((1-(TT3.worth/TT6.max_worth))*100),2) AS worth_similar
			,ROUND(((1-(TT3.personality/TT6.max_personality))*100),2) AS personality_similar
			,(ROUND(((1-(TT3.worth/TT6.max_worth))*100),2)+ROUND(((1-(TT3.personality/TT6.max_personality))*100),2)) / 2 AS total_similar
		 FROM (
			SELECT 
			TT2.survey_id
			,TT2.responder_id
			,ROUND(SQRT(
			POWER((TT1.STEN_VA1-TT2.STEN_VA1),2)
			+POWER((TT1.STEN_VA2-TT2.STEN_VA2),2)
			+POWER((TT1.STEN_VA3-TT2.STEN_VA3),2)
			+POWER((TT1.STEN_VA4-TT2.STEN_VA4),2)
			),2) AS worth
			,ROUND(SQRT(
			POWER((TT1.STEN_ISO-TT2.STEN_ISO),2)
			+POWER((TT1.STEN_PAS-TT2.STEN_PAS),2)
			+POWER((TT1.STEN_RKT-TT2.STEN_RKT),2)
			+POWER((TT1.STEN_ECT-TT2.STEN_ECT),2)
			+POWER((TT1.STEN_NAR-TT2.STEN_NAR),2)
			+POWER((TT1.STEN_POW-TT2.STEN_POW),2)
			+POWER((TT1.STEN_SST-TT2.STEN_SST),2)
			+POWER((TT1.STEN_ATS-TT2.STEN_ATS),2)
			),2) AS personality
			FROM 
			(
			SELECT
			T1.survey_id
			,T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso 
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_HOLDER_SUMMARY T1 WHERE T1.survey_id = #{survey_id} AND T1.REPRESENTATIVE_YN = 'Y'
			) TT1
			JOIN
			(SELECT
			T1.survey_id
			, T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso 
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_SURVEY_SUMMARY T1 WHERE T1.survey_id = #{survey_id} AND T1.SUMMARY_STEP = 7) TT2
		 ) TT3  
		 JOIN
			(
			SELECT 
			TT5.survey_id
			,ROUND(MAX(SQRT(
			POWER((TT4.STEN_VA1-TT5.STEN_VA1),2)
			+POWER((TT4.STEN_VA2-TT5.STEN_VA2),2)
			+POWER((TT4.STEN_VA3-TT5.STEN_VA3),2)
			+POWER((TT4.STEN_VA4-TT5.STEN_VA4),2)
			)),2) AS max_worth
			,ROUND(MAX(SQRT(
			POWER((TT4.STEN_ISO-TT5.STEN_ISO),2)
			+POWER((TT4.STEN_PAS-TT5.STEN_PAS),2)
			+POWER((TT4.STEN_RKT-TT5.STEN_RKT),2)
			+POWER((TT4.STEN_ECT-TT5.STEN_ECT),2)
			+POWER((TT4.STEN_NAR-TT5.STEN_NAR),2)
			+POWER((TT4.STEN_POW-TT5.STEN_POW),2)
			+POWER((TT4.STEN_SST-TT5.STEN_SST),2)
			+POWER((TT4.STEN_ATS-TT5.STEN_ATS),2)
			)),2) AS max_personality
			FROM 
			(
			SELECT
			T1.survey_id
			,T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso 
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_HOLDER_SUMMARY T1 WHERE T1.survey_id = #{survey_id} AND T1.REPRESENTATIVE_YN = 'Y'
			) TT4
			JOIN
			(SELECT
			T1.survey_id
			, T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_SURVEY_SUMMARY T1 WHERE T1.survey_id = #{survey_id} AND T1.SUMMARY_STEP = 7
			) TT5
			GROUP BY TT4.survey_id
			) TT6
		 ON TT3.survey_id = TT6.survey_id
		 ORDER BY ((ROUND(((1-(TT3.worth/TT6.max_worth))*100),2)+ROUND(((1-(TT3.personality/TT6.max_personality))*100),2)) / 2) DESC
	</select>
		
	<!-- 대표구성원 max_worth,max_personality -->
	<select id="getSurveyRepresentativeMaxById" parameterType="box" resultType="box">
		 SELECT 
			TT2.recruit_survey_id
			,MAX(ROUND(SQRT(
			POWER((TT1.STEN_VA1-TT2.STEN_VA1),2)
			+POWER((TT1.STEN_VA2-TT2.STEN_VA2),2)
			+POWER((TT1.STEN_VA3-TT2.STEN_VA3),2)
			+POWER((TT1.STEN_VA4-TT2.STEN_VA4),2)
			),2)) AS max_worth
			,MAX(ROUND(SQRT(
			POWER((TT1.STEN_ISO-TT2.STEN_ISO),2)
			+POWER((TT1.STEN_PAS-TT2.STEN_PAS),2)
			+POWER((TT1.STEN_RKT-TT2.STEN_RKT),2)
			+POWER((TT1.STEN_ECT-TT2.STEN_ECT),2)
			+POWER((TT1.STEN_NAR-TT2.STEN_NAR),2)
			+POWER((TT1.STEN_POW-TT2.STEN_POW),2)
			+POWER((TT1.STEN_SST-TT2.STEN_SST),2)
			+POWER((TT1.STEN_ATS-TT2.STEN_ATS),2)
			),2)) AS max_personality
			FROM 
			(
			SELECT
			T1.recruit_survey_id
			,T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso 
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_SURVEY_SUMMARY T1 WHERE T1.RECRUIT_SURVEY_ID = #{recruit_survey_id} AND T1.RESPONDER_ID = #{responder_id}
			) TT1
			JOIN
			(SELECT
			#{recruit_survey_id} as recruit_survey_id
			, T1.responder_id
			, T1.sten_va1
			, T1.sten_va2
			, T1.sten_va3
			, T1.sten_va4
			, T1.sten_iso 
			, T1.sten_pas
			, T1.sten_rkt
			, T1.sten_ect
			, T1.sten_nar
			, T1.sten_pow
			, T1.sten_sst
			, T1.sten_ats
			FROM TB_HOLDER_SUMMARY T1 
			) TT2
			GROUP BY TT2.recruit_survey_id
	</select>
</mapper>