<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="notice" >
	
	<insert id="insertNotice" parameterType="NoticeVO">
		INSERT INTO TB_NOTICE (
				company_id,
				notice_title,
				notice_contents,
				notice_main,
				notice_writter,
				updt_date,
				reg_date
			)
			VALUES
			(
				#{company_id},
				#{notice_title},
				#{notice_contents},
				#{notice_main},
				#{notice_writter},
				NOW(),
				NOW()
			 )
	</insert>
	
	
	<update id="updateNotice" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_title = #{notice_title}
		       , notice_contents = #{notice_contents}
		   	   , updt_date = NOW()
		 WHERE notice_id = #{notice_id}
	</update>
	
	<delete id="deleteNotice" parameterType="NoticeVO">
		 DELETE FROM TB_NOTICE 
		WHERE notice_id = #{notice_id}
	</delete>
	
	<update id="updateMain" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_main = #{notice_main}
		 WHERE notice_id = #{notice_id}
	</update>
	
	<select id="selectNoticeList" parameterType="NoticeVO" resultType="NoticeVO">
		SELECT (
			SELECT COMPANY_NAME
			  FROM TB_SITE
			 WHERE company_id = '0'
			 LIMIT 1
		) AS company_name
		, notice_id
		, notice_title
		, notice_contents
		, notice_writter
		, notice_main
		, company_id
		, notice_like_count
		, notice_scrap_count
		, notice_comment_count
		, reg_date
		, updt_date
		  FROM TB_NOTICE
		 WHERE company_id = '0'
		UNION ALL
		SELECT (
			SELECT COMPANY_NAME
			  FROM TB_SITE
			 WHERE company_id = #{company_id}
			 LIMIT 1
		) AS company_name
		, notice_id
		, notice_title
		, notice_contents
		, notice_writter
		, notice_main
		, company_id
		, notice_like_count
		, notice_scrap_count
		, notice_comment_count
		, reg_date
		, updt_date
		  FROM TB_NOTICE
		WHERE company_id = #{company_id}
		  and company_id != '0'
		ORDER BY notice_main, notice_id
	</select>
	
	<select id="selectMobileNoticeList" parameterType="NoticeVO" resultType="NoticeVO">
		SELECT *
		  FROM TB_NOTICE
		WHERE notice_main = #{notice_main}
	</select>
	
	<select id="selectNoticeDetail" parameterType="NoticeVO" resultType="NoticeVO">
		SELECT *
		  FROM TB_NOTICE
		 WHERE notice_id = #{notice_id}
		 ORDER BY notice_id DESC
	</select>
	
	
	
	
	
	<update id="updateNoticeLikeDown" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_like_count = (notice_like_count-1)
		 WHERE notice_id = #{notice_id}
	</update>
	
	<update id="updateNoticeLikeUp" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_like_count = (notice_like_count+1)
		 WHERE notice_id = #{notice_id}
	</update>
	
	<update id="updateNoticeScrapDown" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_scrap_count = (notice_scrap_count-1)
		 WHERE notice_id = #{notice_id}
	</update>
	
	<update id="updateNoticeScrapUp" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_scrap_count = (notice_scrap_count+1)
		 WHERE notice_id = #{notice_id}
	</update>
	
	<update id="updateNoticeCommentDown" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_comment_count = (notice_comment_count-1)
		 WHERE notice_id = #{notice_id}
	</update>
	
	<update id="updateNoticeCommentUp" parameterType="NoticeVO">
		 UPDATE TB_NOTICE
		    SET notice_comment_count = (notice_comment_count+1)
		 WHERE notice_id = #{notice_id}
	</update>
	
</mapper>

